<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

<title>EWAS in meffil</title>

<script type="text/javascript">
window.onload = function() {
  var imgs = document.getElementsByTagName('img'), i, img;
  for (i = 0; i < imgs.length; i++) {
    img = imgs[i];
    // center an image if it is the only element of its parent
    if (img.parentElement.childElementCount === 1)
      img.parentElement.style.textAlign = 'center';
  }
};
</script>

<!-- Styles for R syntax highlighter -->
<style type="text/css">
   pre .operator,
   pre .paren {
     color: rgb(104, 118, 135)
   }

   pre .literal {
     color: #990073
   }

   pre .number {
     color: #099;
   }

   pre .comment {
     color: #998;
     font-style: italic
   }

   pre .keyword {
     color: #900;
     font-weight: bold
   }

   pre .identifier {
     color: rgb(0, 0, 0);
   }

   pre .string {
     color: #d14;
   }
</style>

<!-- R syntax highlighter -->
<script type="text/javascript">
var hljs=new function(){function m(p){return p.replace(/&/gm,"&amp;").replace(/</gm,"&lt;")}function f(r,q,p){return RegExp(q,"m"+(r.cI?"i":"")+(p?"g":""))}function b(r){for(var p=0;p<r.childNodes.length;p++){var q=r.childNodes[p];if(q.nodeName=="CODE"){return q}if(!(q.nodeType==3&&q.nodeValue.match(/\s+/))){break}}}function h(t,s){var p="";for(var r=0;r<t.childNodes.length;r++){if(t.childNodes[r].nodeType==3){var q=t.childNodes[r].nodeValue;if(s){q=q.replace(/\n/g,"")}p+=q}else{if(t.childNodes[r].nodeName=="BR"){p+="\n"}else{p+=h(t.childNodes[r])}}}if(/MSIE [678]/.test(navigator.userAgent)){p=p.replace(/\r/g,"\n")}return p}function a(s){var r=s.className.split(/\s+/);r=r.concat(s.parentNode.className.split(/\s+/));for(var q=0;q<r.length;q++){var p=r[q].replace(/^language-/,"");if(e[p]){return p}}}function c(q){var p=[];(function(s,t){for(var r=0;r<s.childNodes.length;r++){if(s.childNodes[r].nodeType==3){t+=s.childNodes[r].nodeValue.length}else{if(s.childNodes[r].nodeName=="BR"){t+=1}else{if(s.childNodes[r].nodeType==1){p.push({event:"start",offset:t,node:s.childNodes[r]});t=arguments.callee(s.childNodes[r],t);p.push({event:"stop",offset:t,node:s.childNodes[r]})}}}}return t})(q,0);return p}function k(y,w,x){var q=0;var z="";var s=[];function u(){if(y.length&&w.length){if(y[0].offset!=w[0].offset){return(y[0].offset<w[0].offset)?y:w}else{return w[0].event=="start"?y:w}}else{return y.length?y:w}}function t(D){var A="<"+D.nodeName.toLowerCase();for(var B=0;B<D.attributes.length;B++){var C=D.attributes[B];A+=" "+C.nodeName.toLowerCase();if(C.value!==undefined&&C.value!==false&&C.value!==null){A+='="'+m(C.value)+'"'}}return A+">"}while(y.length||w.length){var v=u().splice(0,1)[0];z+=m(x.substr(q,v.offset-q));q=v.offset;if(v.event=="start"){z+=t(v.node);s.push(v.node)}else{if(v.event=="stop"){var p,r=s.length;do{r--;p=s[r];z+=("</"+p.nodeName.toLowerCase()+">")}while(p!=v.node);s.splice(r,1);while(r<s.length){z+=t(s[r]);r++}}}}return z+m(x.substr(q))}function j(){function q(x,y,v){if(x.compiled){return}var u;var s=[];if(x.k){x.lR=f(y,x.l||hljs.IR,true);for(var w in x.k){if(!x.k.hasOwnProperty(w)){continue}if(x.k[w] instanceof Object){u=x.k[w]}else{u=x.k;w="keyword"}for(var r in u){if(!u.hasOwnProperty(r)){continue}x.k[r]=[w,u[r]];s.push(r)}}}if(!v){if(x.bWK){x.b="\\b("+s.join("|")+")\\s"}x.bR=f(y,x.b?x.b:"\\B|\\b");if(!x.e&&!x.eW){x.e="\\B|\\b"}if(x.e){x.eR=f(y,x.e)}}if(x.i){x.iR=f(y,x.i)}if(x.r===undefined){x.r=1}if(!x.c){x.c=[]}x.compiled=true;for(var t=0;t<x.c.length;t++){if(x.c[t]=="self"){x.c[t]=x}q(x.c[t],y,false)}if(x.starts){q(x.starts,y,false)}}for(var p in e){if(!e.hasOwnProperty(p)){continue}q(e[p].dM,e[p],true)}}function d(B,C){if(!j.called){j();j.called=true}function q(r,M){for(var L=0;L<M.c.length;L++){if((M.c[L].bR.exec(r)||[null])[0]==r){return M.c[L]}}}function v(L,r){if(D[L].e&&D[L].eR.test(r)){return 1}if(D[L].eW){var M=v(L-1,r);return M?M+1:0}return 0}function w(r,L){return L.i&&L.iR.test(r)}function K(N,O){var M=[];for(var L=0;L<N.c.length;L++){M.push(N.c[L].b)}var r=D.length-1;do{if(D[r].e){M.push(D[r].e)}r--}while(D[r+1].eW);if(N.i){M.push(N.i)}return f(O,M.join("|"),true)}function p(M,L){var N=D[D.length-1];if(!N.t){N.t=K(N,E)}N.t.lastIndex=L;var r=N.t.exec(M);return r?[M.substr(L,r.index-L),r[0],false]:[M.substr(L),"",true]}function z(N,r){var L=E.cI?r[0].toLowerCase():r[0];var M=N.k[L];if(M&&M instanceof Array){return M}return false}function F(L,P){L=m(L);if(!P.k){return L}var r="";var O=0;P.lR.lastIndex=0;var M=P.lR.exec(L);while(M){r+=L.substr(O,M.index-O);var N=z(P,M);if(N){x+=N[1];r+='<span class="'+N[0]+'">'+M[0]+"</span>"}else{r+=M[0]}O=P.lR.lastIndex;M=P.lR.exec(L)}return r+L.substr(O,L.length-O)}function J(L,M){if(M.sL&&e[M.sL]){var r=d(M.sL,L);x+=r.keyword_count;return r.value}else{return F(L,M)}}function I(M,r){var L=M.cN?'<span class="'+M.cN+'">':"";if(M.rB){y+=L;M.buffer=""}else{if(M.eB){y+=m(r)+L;M.buffer=""}else{y+=L;M.buffer=r}}D.push(M);A+=M.r}function G(N,M,Q){var R=D[D.length-1];if(Q){y+=J(R.buffer+N,R);return false}var P=q(M,R);if(P){y+=J(R.buffer+N,R);I(P,M);return P.rB}var L=v(D.length-1,M);if(L){var O=R.cN?"</span>":"";if(R.rE){y+=J(R.buffer+N,R)+O}else{if(R.eE){y+=J(R.buffer+N,R)+O+m(M)}else{y+=J(R.buffer+N+M,R)+O}}while(L>1){O=D[D.length-2].cN?"</span>":"";y+=O;L--;D.length--}var r=D[D.length-1];D.length--;D[D.length-1].buffer="";if(r.starts){I(r.starts,"")}return R.rE}if(w(M,R)){throw"Illegal"}}var E=e[B];var D=[E.dM];var A=0;var x=0;var y="";try{var s,u=0;E.dM.buffer="";do{s=p(C,u);var t=G(s[0],s[1],s[2]);u+=s[0].length;if(!t){u+=s[1].length}}while(!s[2]);if(D.length>1){throw"Illegal"}return{r:A,keyword_count:x,value:y}}catch(H){if(H=="Illegal"){return{r:0,keyword_count:0,value:m(C)}}else{throw H}}}function g(t){var p={keyword_count:0,r:0,value:m(t)};var r=p;for(var q in e){if(!e.hasOwnProperty(q)){continue}var s=d(q,t);s.language=q;if(s.keyword_count+s.r>r.keyword_count+r.r){r=s}if(s.keyword_count+s.r>p.keyword_count+p.r){r=p;p=s}}if(r.language){p.second_best=r}return p}function i(r,q,p){if(q){r=r.replace(/^((<[^>]+>|\t)+)/gm,function(t,w,v,u){return w.replace(/\t/g,q)})}if(p){r=r.replace(/\n/g,"<br>")}return r}function n(t,w,r){var x=h(t,r);var v=a(t);var y,s;if(v){y=d(v,x)}else{return}var q=c(t);if(q.length){s=document.createElement("pre");s.innerHTML=y.value;y.value=k(q,c(s),x)}y.value=i(y.value,w,r);var u=t.className;if(!u.match("(\\s|^)(language-)?"+v+"(\\s|$)")){u=u?(u+" "+v):v}if(/MSIE [678]/.test(navigator.userAgent)&&t.tagName=="CODE"&&t.parentNode.tagName=="PRE"){s=t.parentNode;var p=document.createElement("div");p.innerHTML="<pre><code>"+y.value+"</code></pre>";t=p.firstChild.firstChild;p.firstChild.cN=s.cN;s.parentNode.replaceChild(p.firstChild,s)}else{t.innerHTML=y.value}t.className=u;t.result={language:v,kw:y.keyword_count,re:y.r};if(y.second_best){t.second_best={language:y.second_best.language,kw:y.second_best.keyword_count,re:y.second_best.r}}}function o(){if(o.called){return}o.called=true;var r=document.getElementsByTagName("pre");for(var p=0;p<r.length;p++){var q=b(r[p]);if(q){n(q,hljs.tabReplace)}}}function l(){if(window.addEventListener){window.addEventListener("DOMContentLoaded",o,false);window.addEventListener("load",o,false)}else{if(window.attachEvent){window.attachEvent("onload",o)}else{window.onload=o}}}var e={};this.LANGUAGES=e;this.highlight=d;this.highlightAuto=g;this.fixMarkup=i;this.highlightBlock=n;this.initHighlighting=o;this.initHighlightingOnLoad=l;this.IR="[a-zA-Z][a-zA-Z0-9_]*";this.UIR="[a-zA-Z_][a-zA-Z0-9_]*";this.NR="\\b\\d+(\\.\\d+)?";this.CNR="\\b(0[xX][a-fA-F0-9]+|(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)";this.BNR="\\b(0b[01]+)";this.RSR="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|\\.|-|-=|/|/=|:|;|<|<<|<<=|<=|=|==|===|>|>=|>>|>>=|>>>|>>>=|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~";this.ER="(?![\\s\\S])";this.BE={b:"\\\\.",r:0};this.ASM={cN:"string",b:"'",e:"'",i:"\\n",c:[this.BE],r:0};this.QSM={cN:"string",b:'"',e:'"',i:"\\n",c:[this.BE],r:0};this.CLCM={cN:"comment",b:"//",e:"$"};this.CBLCLM={cN:"comment",b:"/\\*",e:"\\*/"};this.HCM={cN:"comment",b:"#",e:"$"};this.NM={cN:"number",b:this.NR,r:0};this.CNM={cN:"number",b:this.CNR,r:0};this.BNM={cN:"number",b:this.BNR,r:0};this.inherit=function(r,s){var p={};for(var q in r){p[q]=r[q]}if(s){for(var q in s){p[q]=s[q]}}return p}}();hljs.LANGUAGES.cpp=function(){var a={keyword:{"false":1,"int":1,"float":1,"while":1,"private":1,"char":1,"catch":1,"export":1,virtual:1,operator:2,sizeof:2,dynamic_cast:2,typedef:2,const_cast:2,"const":1,struct:1,"for":1,static_cast:2,union:1,namespace:1,unsigned:1,"long":1,"throw":1,"volatile":2,"static":1,"protected":1,bool:1,template:1,mutable:1,"if":1,"public":1,friend:2,"do":1,"return":1,"goto":1,auto:1,"void":2,"enum":1,"else":1,"break":1,"new":1,extern:1,using:1,"true":1,"class":1,asm:1,"case":1,typeid:1,"short":1,reinterpret_cast:2,"default":1,"double":1,register:1,explicit:1,signed:1,typename:1,"try":1,"this":1,"switch":1,"continue":1,wchar_t:1,inline:1,"delete":1,alignof:1,char16_t:1,char32_t:1,constexpr:1,decltype:1,noexcept:1,nullptr:1,static_assert:1,thread_local:1,restrict:1,_Bool:1,complex:1},built_in:{std:1,string:1,cin:1,cout:1,cerr:1,clog:1,stringstream:1,istringstream:1,ostringstream:1,auto_ptr:1,deque:1,list:1,queue:1,stack:1,vector:1,map:1,set:1,bitset:1,multiset:1,multimap:1,unordered_set:1,unordered_map:1,unordered_multiset:1,unordered_multimap:1,array:1,shared_ptr:1}};return{dM:{k:a,i:"</",c:[hljs.CLCM,hljs.CBLCLM,hljs.QSM,{cN:"string",b:"'\\\\?.",e:"'",i:"."},{cN:"number",b:"\\b(\\d+(\\.\\d*)?|\\.\\d+)(u|U|l|L|ul|UL|f|F)"},hljs.CNM,{cN:"preprocessor",b:"#",e:"$"},{cN:"stl_container",b:"\\b(deque|list|queue|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array)\\s*<",e:">",k:a,r:10,c:["self"]}]}}}();hljs.LANGUAGES.r={dM:{c:[hljs.HCM,{cN:"number",b:"\\b0[xX][0-9a-fA-F]+[Li]?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+(?:[eE][+\\-]?\\d*)?L\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+\\.(?!\\d)(?:i\\b)?",e:hljs.IMMEDIATE_RE,r:1},{cN:"number",b:"\\b\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\.\\d+(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"keyword",b:"(?:tryCatch|library|setGeneric|setGroupGeneric)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\.",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\d+(?![\\w.])",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\b(?:function)",e:hljs.IMMEDIATE_RE,r:2},{cN:"keyword",b:"(?:if|in|break|next|repeat|else|for|return|switch|while|try|stop|warning|require|attach|detach|source|setMethod|setClass)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"literal",b:"(?:NA|NA_integer_|NA_real_|NA_character_|NA_complex_)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"literal",b:"(?:NULL|TRUE|FALSE|T|F|Inf|NaN)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"identifier",b:"[a-zA-Z.][a-zA-Z0-9._]*\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"<\\-(?!\\s*\\d)",e:hljs.IMMEDIATE_RE,r:2},{cN:"operator",b:"\\->|<\\-",e:hljs.IMMEDIATE_RE,r:1},{cN:"operator",b:"%%|~",e:hljs.IMMEDIATE_RE},{cN:"operator",b:">=|<=|==|!=|\\|\\||&&|=|\\+|\\-|\\*|/|\\^|>|<|!|&|\\||\\$|:",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"%",e:"%",i:"\\n",r:1},{cN:"identifier",b:"`",e:"`",r:0},{cN:"string",b:'"',e:'"',c:[hljs.BE],r:0},{cN:"string",b:"'",e:"'",c:[hljs.BE],r:0},{cN:"paren",b:"[[({\\])}]",e:hljs.IMMEDIATE_RE,r:0}]}};
hljs.initHighlightingOnLoad();
</script>



<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 13px;
}

body {
  max-width: 800px;
  margin: auto;
  padding: 1em;
  line-height: 20px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 {
   font-size:2.2em;
}

h2 {
   font-size:1.8em;
}

h3 {
   font-size:1.4em;
}

h4 {
   font-size:1.0em;
}

h5 {
   font-size:0.9em;
}

h6 {
   font-size:0.8em;
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre, img {
  max-width: 100%;
}
pre {
  overflow-x: auto;
}
pre code {
   display: block; padding: 0.5em;
}

code {
  font-size: 92%;
  border: 1px solid #ccc;
}

code[class] {
  background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * {
      background: transparent !important;
      color: black !important;
      filter:none !important;
      -ms-filter: none !important;
   }

   body {
      font-size:12pt;
      max-width:100%;
   }

   a, a:visited {
      text-decoration: underline;
   }

   hr {
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote {
      padding-right: 1em;
      page-break-inside: avoid;
   }

   tr, img {
      page-break-inside: avoid;
   }

   img {
      max-width: 100% !important;
   }

   @page :left {
      margin: 15mm 20mm 15mm 10mm;
   }

   @page :right {
      margin: 15mm 10mm 15mm 20mm;
   }

   p, h2, h3 {
      orphans: 3; widows: 3;
   }

   h2, h3 {
      page-break-after: avoid;
   }
}
</style>



</head>

<body>
<h1>EWAS in meffil</h1>

<h2>Download example data set</h2>

<blockquote>
<p>Sen A, Cingolani P, Senut MC, Land S et al. Lead exposure induces
changes in 5-hydroxymethylcytosine clusters in CpG islands in human
embryonic stem cells and umbilical cord blood. Epigenetics
2015;10(7):607-21. PMID: 26046694</p>
</blockquote>

<p>Retrieve the data from the Gene Expression Omnibus (GEO) website
(<a href="http://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE69633">http://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE69633</a>).</p>

<pre><code class="r">download.450k.lead.dataset &lt;- function() {
    dir.create(path &lt;- &quot;data-450k-lead&quot;)

    if (length(list.files(path, &quot;*.idat$&quot;)) == 0) {
        filename &lt;-  file.path(path, &quot;gse69633.tar&quot;)
        download.file(&quot;http://www.ncbi.nlm.nih.gov/geo/download/?acc=GSE69633&amp;format=file&quot;, filename)
        cat(date(), &quot;Extracting files from GEO archive.\n&quot;)
        system(paste(&quot;cd&quot;, path, &quot;;&quot;, &quot;tar xvf&quot;, basename(filename)))
        unlink(filename)
        cat(date(), &quot;Unzipping IDAT files.\n&quot;)
        system(paste(&quot;cd&quot;, path, &quot;;&quot;, &quot;gunzip *.idat.gz&quot;))

        library(GEOquery)
        geo &lt;- getGEO(&quot;GSE69633&quot;, GSEMatrix=F)
        ## this output from geo is really messed up.
        xx &lt;- lapply(geo@gsms, function(x) x@header)
        characteristics &lt;- t(sapply(xx, function(x) x$characteristics_ch1))
        colnames(characteristics) &lt;- sub(&quot;([^:]+):.*&quot;, &quot;\\1&quot;, characteristics[1,])
        rownames(characteristics) &lt;- names(xx)
        characteristics &lt;- apply(characteristics, 2, function(x) sub(&quot;[^:]+: (.*)&quot;, &quot;\\1&quot;, x))
        characteristics &lt;- as.data.frame(characteristics, stringsAsFactors=F)
        for (name in c(&quot;socioeconomic score&quot;, &quot;gestational age&quot;, &quot;birth weight&quot;, &quot;pbconc (ng/dl)&quot;))
            characteristics[[name]] &lt;- as.numeric(characteristics[[name]])
        write.csv(characteristics, file=file.path(path, &quot;samples.csv&quot;))
    }

    path
}
</code></pre>

<pre><code class="r">path &lt;- download.450k.lead.dataset()
</code></pre>

<h2>Normalize dataset</h2>

<p>Create samplesheet</p>

<pre><code class="r">library(meffil)
</code></pre>

<pre><code>## Loading required package: illuminaio
</code></pre>

<pre><code>## Loading required package: MASS
</code></pre>

<pre><code>## Loading required package: lmtest
</code></pre>

<pre><code>## Loading required package: zoo
</code></pre>

<pre><code>## 
## Attaching package: &#39;zoo&#39;
</code></pre>

<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     as.Date, as.Date.numeric
</code></pre>

<pre><code>## Loading required package: sandwich
</code></pre>

<pre><code>## Loading required package: limma
</code></pre>

<pre><code>## 
## Attaching package: &#39;limma&#39;
</code></pre>

<pre><code>## The following object is masked from &#39;package:BiocGenerics&#39;:
## 
##     plotMA
</code></pre>

<pre><code>## Loading required package: sva
</code></pre>

<pre><code>## Loading required package: mgcv
</code></pre>

<pre><code>## Loading required package: nlme
</code></pre>

<pre><code>## This is mgcv 1.8-28. For overview type &#39;help(&quot;mgcv-package&quot;)&#39;.
</code></pre>

<pre><code>## Loading required package: genefilter
</code></pre>

<pre><code>## 
## Attaching package: &#39;genefilter&#39;
</code></pre>

<pre><code>## The following object is masked from &#39;package:MASS&#39;:
## 
##     area
</code></pre>

<pre><code>## Loading required package: BiocParallel
</code></pre>

<pre><code>## Loading required package: ggplot2
</code></pre>

<pre><code>## Loading required package: plyr
</code></pre>

<pre><code>## Loading required package: reshape2
</code></pre>

<pre><code>## Loading required package: gridExtra
</code></pre>

<pre><code>## 
## Attaching package: &#39;gridExtra&#39;
</code></pre>

<pre><code>## The following object is masked from &#39;package:Biobase&#39;:
## 
##     combine
</code></pre>

<pre><code>## The following object is masked from &#39;package:BiocGenerics&#39;:
## 
##     combine
</code></pre>

<pre><code>## Loading required package: markdown
</code></pre>

<pre><code>## Loading required package: matrixStats
</code></pre>

<pre><code>## 
## Attaching package: &#39;matrixStats&#39;
</code></pre>

<pre><code>## The following object is masked from &#39;package:plyr&#39;:
## 
##     count
</code></pre>

<pre><code>## The following objects are masked from &#39;package:genefilter&#39;:
## 
##     rowSds, rowVars
</code></pre>

<pre><code>## The following objects are masked from &#39;package:Biobase&#39;:
## 
##     anyMissing, rowMedians
</code></pre>

<pre><code>## Loading required package: multcomp
</code></pre>

<pre><code>## Loading required package: mvtnorm
</code></pre>

<pre><code>## Loading required package: TH.data
</code></pre>

<pre><code>## 
## Attaching package: &#39;TH.data&#39;
</code></pre>

<pre><code>## The following object is masked from &#39;package:MASS&#39;:
## 
##     geyser
</code></pre>

<pre><code>## Loading required package: lme4
</code></pre>

<pre><code>## Loading required package: Matrix
</code></pre>

<pre><code>## 
## Attaching package: &#39;lme4&#39;
</code></pre>

<pre><code>## The following object is masked from &#39;package:nlme&#39;:
## 
##     lmList
</code></pre>

<pre><code>## Loading required package: fastICA
</code></pre>

<pre><code>## Loading required package: DNAcopy
</code></pre>

<pre><code>## Loading required package: quadprog
</code></pre>

<pre><code>## Loading required package: statmod
</code></pre>

<pre><code>## Loading required package: gdsfmt
</code></pre>

<pre><code>## Loading required package: SmartSVA
</code></pre>

<pre><code>## Loading required package: isva
</code></pre>

<pre><code>## Loading required package: qvalue
</code></pre>

<pre><code>## 
## Attaching package: &#39;qvalue&#39;
</code></pre>

<pre><code>## The following object is masked from &#39;package:ggplot2&#39;:
## 
##     qplot
</code></pre>

<pre><code>## Loading required package: JADE
</code></pre>

<pre><code>## Loading required package: RSpectra
</code></pre>

<pre><code>## Loading required package: preprocessCore
</code></pre>

<pre><code class="r">options(mc.cores=10)
samplesheet &lt;- meffil.create.samplesheet(path)

samples &lt;- read.csv(file.path(path, &quot;samples.csv&quot;), check.names=F, row.names=1)
samplesheet &lt;- data.frame(samplesheet,
                          samples[match(samplesheet$Sample_Name, rownames(samples)),],
                          stringsAsFactors=F, check.names=F)

samplesheet &lt;- samplesheet[which(samplesheet[[&quot;sample type&quot;]] == &quot;HM450K&quot;),]
</code></pre>

<p>Parameters.</p>

<pre><code class="r">qc.file &lt;- &quot;ewas/qc-report.html&quot;
author &lt;- &quot;Sen, et al.&quot;
study &lt;- &quot;Cord blood DNA methylation and lead exposure (GSE69633)&quot;
norm.file &lt;- &quot;ewas/normalization-report.html&quot;
cell.type.reference &lt;- &quot;gervin and lyle cord blood&quot;
</code></pre>

<p>Generate QC objects for each sample and QC report.</p>

<pre><code class="r">qc.objects &lt;- meffil.qc(samplesheet, cell.type.reference=cell.type.reference, verbose=T)
</code></pre>

<pre><code>## [read.idat] Fri Jun 25 14:04:58 2021 Reading data-450k-lead/GSM1704996_5815073001_R04C01_Grn.idat 
## [read.idat] Fri Jun 25 14:04:58 2021 Reading data-450k-lead/GSM1704996_5815073001_R04C01_Red.idat 
## [extract.detection.pvalues] Fri Jun 25 14:04:59 2021  
## [extract.beadnum] Fri Jun 25 14:05:03 2021  
## [extract.snp.betas] Fri Jun 25 14:05:06 2021  
## [extract.controls] Fri Jun 25 14:05:06 2021  
## [background.correct] Fri Jun 25 14:05:07 2021 background correction for dye = R 
## [background.correct] Fri Jun 25 14:05:09 2021 background correction for dye = G 
## [dye.bias.correct] Fri Jun 25 14:05:10 2021  
## [FUN] Fri Jun 25 14:05:15 2021 predicting sex
</code></pre>

<pre><code class="r">qc.summary &lt;- meffil.qc.summary(qc.objects, verbose=T)
</code></pre>

<pre><code>## [meffil.qc.summary] Fri Jun 25 14:07:08 2021 Sex summary TRUE 
## [meffil.qc.summary] Fri Jun 25 14:07:08 2021 Meth vs unmeth summary 
## [meffil.qc.summary] Fri Jun 25 14:07:08 2021 Control means summary 
## [meffil.qc.summary] Fri Jun 25 14:07:08 2021 Sample detection summary 
## [meffil.qc.summary] Fri Jun 25 14:07:10 2021 CpG detection summary 
## [meffil.qc.summary] Fri Jun 25 14:07:10 2021 Sample bead numbers summary 
## [meffil.qc.summary] Fri Jun 25 14:07:13 2021 CpG bead numbers summary 
## [meffil.qc.summary] Fri Jun 25 14:07:14 2021 Cell count summary 
## [meffil.qc.summary] Fri Jun 25 14:07:14 2021 Genotype concordance
</code></pre>

<pre><code class="r">meffil.qc.report(qc.summary,
                 output.file=qc.file,
                 author=author,
                 study=study)
</code></pre>

<pre><code>## [meffil.qc.report] Fri Jun 25 14:07:14 2021 Writing report as html file to ewas/qc-report.html
</code></pre>

<pre><code>## `geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;
</code></pre>

<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
</code></pre>

<p>Remove any low quality samples.</p>

<pre><code class="r">if (nrow(qc.summary$bad.samples) &gt; 0)
    qc.objects &lt;- meffil.remove.samples(qc.objects, qc.summary$bad.samples$sample.name)

samplesheet &lt;- samplesheet[match(names(qc.objects), rownames(samplesheet)),]
</code></pre>

<p>Check how many principal components to include.</p>

<pre><code class="r">print(meffil.plot.pc.fit(qc.objects, n.cross=3)$plot)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAbAAAAGwCAIAAABHLKd9AAAABmJLR0QA/wD/AP+gvaeTAAAgAElEQVR4nOzdeWAU5f0/8Od55t6d3WzYECAJVwIJMRwqh8gtMQSpyuVZi7YKHlj9xdavhar90q/9ou3Xs4haQ1FqxQtFURAhHHJUzoioyBXOEALk3Puamd8fE8K6ZJNNdrLn5/XXzmb22c/M7r4z5/NgRVEQAAAAhEi0CwAAgFgBgQgAAE0gEAEAoAkEIgAANInXQLz22mvxz3Xt2vXMmTMYY7vdjhAaMmTIl19+qeE7+jfu791337322ms70GBtbS3GuLa2NpSZV65cmZ2d/d///d8deKMAzQX7L5F/+xq+VzCafzot2rBhQ9++fTv7XVoUbB2OHTu2+RsrCMLQoUPXrl3b/NdTp07deeed2dnZBoNh6NChy5cvj2zVIG4DESFUUlJywk95eXlKSsrzzz/PsixCyOPxyLLcystdLle73s6/8ch74YUXHn/88RBDKsRF818i//Y7470CtPnpRF3HlqtZK+vwt7/9rfqN3blz55AhQ2bMmHH69GmEUEVFxeDBg/V6/dtvv71t27a77rprzpw577zzTjhlgHZT4tPIkSMXLFgQ8GR1dTVCyGazjR07lhCi1+tfeukl/xkaGhoQQrt3787Pz1+yZImiKGfOnJkxY0aXLl0yMjKeeuopn8+nzllaWpqTkyMIwrBhw3bu3OnfuKIoO3fuHDFihNFovP7665999tmRI0cqilJZWYkQam7h8ccff/DBB9XH27dvHz16tMFg6Nq160MPPeT1ehVFqampQQjV1NS0+Hb+Jk+eTFGUTqdTF/nYsWPFxcUpKSl5eXl///vfgy2avxYLbl4i//YD3qvF9RPiarTZbAihlStXZmZmCoJQWFhYXV2tKEqwTyfY/MFWrDr/888/bzKZunTpMm/evG3btqmZMm3aNLfbXVZW1qdPn3/84x85OTnp6ekPPfSQ0+lUGwlxuVr/XIJ9FgHr0N+YMWOeeuqp5kmv16vX69955x1FUSZNmjRnzhz/mZ999tkBAwYE+0KCzpCYgagoyoABA7744ouAGdRv/MSJEzdu3Gi1WiVJGjx48AMPPHD8+PHt27fn5ub+8Y9/VBRl//79hJDly5cfOXLkrrvuKigo8G/8woULoiiWlJQcPnz4tddeYxim9UCUJKlLly5z5849cuTIhg0bjEbj+++/r/gFYotvF2DYsGErVqxQFMXr9WZnZ993330VFRWrVq0ymUzvvvvu5Yvm/9pgBfuvrub2/R8HWz8hrkY1sK666qoff/yxvLy8b9++v/vd79S3aPHTCTZ/64FYVFRUWVlZWlqKECooKDh48ODGjRtpmv7www/Lyspomh49evT+/fs3bNjQs2fPkpKS0Jerzc8l2GcRsD79tRiIS5cuPXfuHELo0KFD/jM7HI6jR4/KshzKNwRoIo4DMWBTt6ysLMRA/PTTT9XJsrKyHj16NP/SPvjgg8GDByuKsnLlSqPRWF9fryjKhQsXvvrqK8UvPl544YX8/HxZltVX3Xrrra0HotPpfOONNywWi/p8YWHh888/r/gFYotvF6D5B7Zq1aquXbu63W71+T//+c+jR4++fNH8BSu4zUAMtn5CXI1qYK1atUp9fv78+bfccov6uJVAvHz+1gNxz549iqLIsmwymd5++211nlGjRr388stlZWX+KfPBBx+IoijLcojL1ebnEuyzUFoNxEcffbSysrKysvLAgQNz5szheb6iomLTpk0MwzSXFCCUbwjQBK3h3neElZSUlJSUNE9269atsbExlBcOGjRIfXD48OELFy50795dnfR6veqBrYkTJw4YMKB3797Tpk275ZZbbrzxRv+XHz58ePTo0RhjdXL06NHvv/9+K2/H8/ztt9++du3a8vLybdu2bd++/YYbbvCfofW3C3D48OErr7yy+VDmiBEjXnvttcsXLZyC/V/Y4voJeK/WZxs4cKD6ICUlJZQ3be/86vtijEVRzMzMVJ80Go3qg9TU1NzcXPXx2LFjbTZbdXV1iMvV5ufS+mcRzN///ve///3vCCFCSP/+/T/44IPs7Ozjx483f0CXa9c3BIQjjk+qmEym3n54ng/xhXq9Xn1gMBhyc3MvXNTQ0GCxWBBCRqNx586dn332mSAI995778iRI/0PsVMU5f/d5TiuxXfx+Xzqg9ra2uHDh7/yyis9e/Z8/fXXp02bFjBn628XQFEU/3cnhDS/kf+i+Qux4MsFWz8B79X6bO09DdXm/P7LG+DyTAlYV2r7IS5Xm59L659FMM27zJIkHTx48Oabb0YIDRw40OPxHD161H/OY8eODR8+/MSJE+36hoBwxHEghi8vL+/gwYPNP4a3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" alt="plot of chunk unnamed-chunk-6"/></p>

<p>Ten seems about right.</p>

<pre><code class="r">number.pcs &lt;- 10
</code></pre>

<p>Normalize dataset and generate normalization report.</p>

<pre><code class="r">norm.objects &lt;- meffil.normalize.quantiles(qc.objects, number.pcs=number.pcs, verbose=T)
</code></pre>

<pre><code>## [meffil.normalize.quantiles] Fri Jun 25 14:07:52 2021 selecting dye correction reference 
## [meffil.normalize.quantiles] Fri Jun 25 14:07:52 2021 creating control matrix 
## [meffil.normalize.quantiles] Fri Jun 25 14:07:52 2021 normalizing quantiles 
## [FUN] Fri Jun 25 14:07:52 2021 genomic.iG M 
## [FUN] Fri Jun 25 14:07:52 2021 genomic.iG U 
## [FUN] Fri Jun 25 14:07:52 2021 genomic.iR M 
## [FUN] Fri Jun 25 14:07:53 2021 genomic.iR U 
## [FUN] Fri Jun 25 14:07:53 2021 genomic.ii M 
## [FUN] Fri Jun 25 14:07:53 2021 genomic.ii U 
## [FUN] Fri Jun 25 14:07:54 2021 autosomal.iG M 
## [FUN] Fri Jun 25 14:07:54 2021 autosomal.iG U 
## [FUN] Fri Jun 25 14:07:54 2021 autosomal.iR M 
## [FUN] Fri Jun 25 14:07:54 2021 autosomal.iR U 
## [FUN] Fri Jun 25 14:07:54 2021 autosomal.ii M 
## [FUN] Fri Jun 25 14:07:54 2021 autosomal.ii U 
## [FUN] Fri Jun 25 14:07:55 2021 not.y.iG M 
## [FUN] Fri Jun 25 14:07:55 2021 not.y.iG U 
## [FUN] Fri Jun 25 14:07:55 2021 not.y.iR M 
## [FUN] Fri Jun 25 14:07:55 2021 not.y.iR U 
## [FUN] Fri Jun 25 14:07:55 2021 not.y.ii M 
## [FUN] Fri Jun 25 14:07:56 2021 not.y.ii U 
## [FUN] Fri Jun 25 14:07:56 2021 sex M 
## [FUN] Fri Jun 25 14:07:56 2021 sex U 
## [FUN] Fri Jun 25 14:07:56 2021 chrx M 
## [FUN] Fri Jun 25 14:07:56 2021 chrx U 
## [FUN] Fri Jun 25 14:07:57 2021 chry M 
## [FUN] Fri Jun 25 14:07:57 2021 chry U
</code></pre>

<pre><code class="r">norm.dataset &lt;- meffil.normalize.samples(norm.objects,
                                         just.beta=F, 
                                         cpglist.remove=qc.summary$bad.cpgs$name,
                                         verbose=T)
</code></pre>

<pre><code>## [read.idat] Fri Jun 25 14:07:57 2021 Reading data-450k-lead/GSM1704996_5815073001_R04C01_Grn.idat 
## [read.idat] Fri Jun 25 14:07:57 2021 Reading data-450k-lead/GSM1704996_5815073001_R04C01_Red.idat 
## [background.correct] Fri Jun 25 14:07:57 2021 background correction for dye = R 
## [background.correct] Fri Jun 25 14:07:59 2021 background correction for dye = G 
## [dye.bias.correct] Fri Jun 25 14:08:01 2021  
## [meffil.normalize.sample] Fri Jun 25 14:08:03 2021 Normalizing methylated and unmethylated signals.
</code></pre>

<pre><code class="r">beta &lt;- meffil.get.beta(norm.dataset$M, norm.dataset$U)
pcs &lt;- meffil.methylation.pcs(beta, sites=meffil.get.autosomal.sites(&quot;450k&quot;), verbose=T)
</code></pre>

<pre><code>## [meffil.methylation.pcs] Fri Jun 25 14:09:07 2021 Calculating CpG variance 
## [meffil.methylation.pcs] Fri Jun 25 14:09:08 2021 Calculating beta PCs
</code></pre>

<pre><code class="r">parameters &lt;- meffil.normalization.parameters(norm.objects)
norm.summary &lt;- meffil.normalization.summary(norm.objects=norm.objects,
                                             pcs=pcs,
                                             parameters=parameters, verbose=T)
</code></pre>

<pre><code>## [meffil.plot.control.batch] Fri Jun 25 14:09:09 2021 Extracting batch variables 
## [meffil.plot.control.batch] Fri Jun 25 14:09:09 2021 Testing associations 
## [meffil.plot.probe.batch] Fri Jun 25 14:09:23 2021 Extracting batch variables 
## [meffil.plot.probe.batch] Fri Jun 25 14:09:23 2021 Testing associations
</code></pre>

<pre><code class="r">meffil.normalization.report(norm.summary,
                            output.file=norm.file,
                            author=author,
                            study=study)
</code></pre>

<pre><code>## [meffil.normalization.report] Fri Jun 25 14:09:34 2021 Writing report as html file to ewas/normalization-report.html
</code></pre>

<h2>Test associations with gestational age</h2>

<p>Parameters.</p>

<pre><code class="r">ewas.variable.name &lt;- &quot;gestational age&quot;
ewas.covariate.names &lt;- c(&quot;socioeconomic score&quot;,&quot;gender&quot;,&quot;smoke ever&quot;,&quot;birth weight&quot;)
ewas.output.file &lt;- &quot;ewas/ewas-gestational-age-report.html&quot;
ewas.author &lt;- &quot;Me&quot;
ewas.study &lt;- &quot;Gestational age in cord blood DNA methylation (GEO:GSE69633)&quot;
ewas.cpg.sites &lt;- c(&quot;cg08943494&quot;, &quot;cg11932158&quot;,&quot;cg16725984&quot;, &quot;cg20334115&quot;, &quot;cg18623216&quot;) 
## PMID: 25869828 (top 5)
</code></pre>

<p>Perform EWAS.</p>

<pre><code class="r">variable &lt;- samplesheet[[ewas.variable.name]]
covariates &lt;- data.frame(t(meffil.cell.count.estimates(qc.objects)),
                         samplesheet[,ewas.covariate.names],
                         stringsAsFactors=F)

ewas.ret &lt;- meffil.ewas(beta,
                        variable=variable,
                        covariates=covariates,
                        isva=F, sva=F, smartsva=T,
                        most.variable=50000,
                        verbose=T)
</code></pre>

<pre><code>## [meffil.ewas] Fri Jun 25 15:00:13 2021 Simplifying any categorical variables. 
## [meffil.ewas] Fri Jun 25 15:00:13 2021 Removing 0 missing case(s). 
## [meffil.ewas] Fri Jun 25 15:00:13 2021 Removing 0 covariates with no variance. 
## [meffil.ewas] Fri Jun 25 15:00:13 2021 Computing surrogate variables ... 
## [add.surrogate.variables] Fri Jun 25 15:00:14 2021 Calculating CpG variance 
## [add.surrogate.variables] Fri Jun 25 15:00:39 2021 smartSVA. 
## 
## [meffil.ewas] Fri Jun 25 15:00:44 2021 Starting EWAS ... 
## [:::] [meffil] [ewas.by.matrix] Fri Jun 25 15:00:45 2021 Handling methylation outliers 
## [FUN] Fri Jun 25 15:01:06 2021 EWAS for covariate set none 
## [:::] [meffil] [ewas.limma] Fri Jun 25 15:01:06 2021 Linear regression with limma::lmFit 
## [:::] [meffil] [ewas.limma] Fri Jun 25 15:01:06 2021 Linear regression with only fixed effects 
## [:::] [meffil] [ewas.limma] Fri Jun 25 15:01:09 2021 Empirical Bayes 
## [FUN] Fri Jun 25 15:01:16 2021 EWAS for covariate set all 
## [:::] [meffil] [ewas.limma] Fri Jun 25 15:01:16 2021 Linear regression with limma::lmFit 
## [:::] [meffil] [ewas.limma] Fri Jun 25 15:01:16 2021 Linear regression with only fixed effects 
## [:::] [meffil] [ewas.limma] Fri Jun 25 15:01:19 2021 Empirical Bayes 
## [FUN] Fri Jun 25 15:01:29 2021 EWAS for covariate set smartsva 
## [:::] [meffil] [ewas.limma] Fri Jun 25 15:01:29 2021 Linear regression with limma::lmFit 
## [:::] [meffil] [ewas.limma] Fri Jun 25 15:01:29 2021 Linear regression with only fixed effects 
## [:::] [meffil] [ewas.limma] Fri Jun 25 15:01:37 2021 Empirical Bayes 
## [meffil.ewas] Fri Jun 25 15:02:02 2021 Finished EWAS.
</code></pre>

<p>Generate EWAS report.</p>

<pre><code class="r">ewas.parameters &lt;- meffil.ewas.parameters(sig.threshold=1e-5,max.plots=10)
ewas.summary &lt;- meffil.ewas.summary(ewas.ret,
                                    beta,
                                    selected.cpg.sites=ewas.cpg.sites,
                                    parameters=ewas.parameters, verbose=T)
</code></pre>

<pre><code>## [meffil.ewas.summary] Fri Jun 25 15:41:00 2021 QQ plots 
## [meffil.ewas.summary] Fri Jun 25 15:41:30 2021 Manhattan plots 
## [meffil.ewas.summary] Fri Jun 25 15:41:35 2021 CpG site plots: 15 
## [FUN] Fri Jun 25 15:41:37 2021 Plotting cg21887373 
## [FUN] Fri Jun 25 15:41:39 2021 Plotting cg09866743 
## [FUN] Fri Jun 25 15:41:39 2021 Plotting cg08594681 
## [FUN] Fri Jun 25 15:41:39 2021 Plotting cg03958883 
## [FUN] Fri Jun 25 15:41:39 2021 Plotting cg00431924 
## [FUN] Fri Jun 25 15:41:39 2021 Plotting cg01824284 
## [FUN] Fri Jun 25 15:41:39 2021 Plotting cg07787614 
## [FUN] Fri Jun 25 15:41:39 2021 Plotting cg12654199 
## [FUN] Fri Jun 25 15:41:39 2021 Plotting cg12036924 
## [FUN] Fri Jun 25 15:41:40 2021 Plotting cg05822633 
## [FUN] Fri Jun 25 15:41:40 2021 Plotting cg08943494 
## [FUN] Fri Jun 25 15:41:40 2021 Plotting cg11932158 
## [FUN] Fri Jun 25 15:41:40 2021 Plotting cg16725984 
## [FUN] Fri Jun 25 15:41:40 2021 Plotting cg20334115 
## [FUN] Fri Jun 25 15:41:40 2021 Plotting cg18623216 
## [meffil.ewas.summary] Fri Jun 25 15:41:40 2021 Sample characteristics 
## [meffil.ewas.sample.characteristics] Fri Jun 25 15:41:40 2021 summarizing variables 
## [summarize.variable] Fri Jun 25 15:41:40 2021 variable of interest 
## [summarize.variable] Fri Jun 25 15:41:40 2021 Bcell 
## [summarize.variable] Fri Jun 25 15:41:40 2021 CD14 
## [summarize.variable] Fri Jun 25 15:41:40 2021 CD4T 
## [summarize.variable] Fri Jun 25 15:41:40 2021 CD8T 
## [summarize.variable] Fri Jun 25 15:41:40 2021 Gran 
## [summarize.variable] Fri Jun 25 15:41:40 2021 NK 
## [summarize.variable] Fri Jun 25 15:41:40 2021 socioeconomic.score 
## [summarize.variable] Fri Jun 25 15:41:40 2021 gender 
## [summarize.variable] Fri Jun 25 15:41:40 2021 smoke.ever 
## [summarize.variable] Fri Jun 25 15:41:40 2021 birth.weight 
## [meffil.ewas.covariate.associations] Fri Jun 25 15:41:40 2021 covariate associations 
## [FUN] Fri Jun 25 15:41:40 2021 Bcell 
## [FUN] Fri Jun 25 15:41:40 2021 CD14 
## [FUN] Fri Jun 25 15:41:40 2021 CD4T 
## [FUN] Fri Jun 25 15:41:40 2021 CD8T 
## [FUN] Fri Jun 25 15:41:40 2021 Gran 
## [FUN] Fri Jun 25 15:41:40 2021 NK 
## [FUN] Fri Jun 25 15:41:40 2021 socioeconomic.score 
## [FUN] Fri Jun 25 15:41:40 2021 gender 
## [FUN] Fri Jun 25 15:41:40 2021 smoke.ever 
## [FUN] Fri Jun 25 15:41:40 2021 birth.weight
</code></pre>

<pre><code class="r">meffil.ewas.report(ewas.summary,
                   output.file=ewas.output.file,
                   author=ewas.author,
                   study=ewas.study)
</code></pre>

<pre><code>## [meffil.ewas.report] Fri Jun 25 15:41:40 2021 Writing report as html file to ewas/ewas-gestational-age-report.html
</code></pre>

<pre><code class="r">idx &lt;- sample(order(ewas.ret$analyses$smartsva$table$p.value)[1:1000],100)
sub.sites &lt;- rownames(beta)[idx]
sub.covariates &lt;- cbind(covariates, with(ewas.ret$analyses$smartsva, design[,grep(&quot;^X[0-9]+$&quot;, colnames(design))]))

ewas.sub.ret &lt;- meffil.ewas(beta,
                            variable=variable,
                            sites=sub.sites,
                            covariates=sub.covariates,
                            sva=F, isva=F, smartsva=F,
                            verbose=T)
</code></pre>

<pre><code>## [meffil.ewas] Fri Jun 25 15:42:36 2021 Simplifying any categorical variables. 
## [meffil.ewas] Fri Jun 25 15:42:36 2021 Removing 0 missing case(s). 
## [meffil.ewas] Fri Jun 25 15:42:36 2021 Removing 0 covariates with no variance. 
## [meffil.ewas] Fri Jun 25 15:42:36 2021 Starting EWAS ... 
## [:::] [meffil] [ewas.by.matrix] Fri Jun 25 15:42:37 2021 Handling methylation outliers 
## [FUN] Fri Jun 25 15:42:37 2021 EWAS for covariate set none 
## [:::] [meffil] [ewas.limma] Fri Jun 25 15:42:37 2021 Linear regression with limma::lmFit 
## [:::] [meffil] [ewas.limma] Fri Jun 25 15:42:37 2021 Linear regression with only fixed effects 
## [:::] [meffil] [ewas.limma] Fri Jun 25 15:42:37 2021 Empirical Bayes 
## [FUN] Fri Jun 25 15:42:37 2021 EWAS for covariate set all 
## [:::] [meffil] [ewas.limma] Fri Jun 25 15:42:37 2021 Linear regression with limma::lmFit 
## [:::] [meffil] [ewas.limma] Fri Jun 25 15:42:37 2021 Linear regression with only fixed effects 
## [:::] [meffil] [ewas.limma] Fri Jun 25 15:42:37 2021 Empirical Bayes 
## [meffil.ewas] Fri Jun 25 15:42:37 2021 Finished EWAS.
</code></pre>

<pre><code class="r">ewas.parameters &lt;- meffil.ewas.parameters(sig.threshold=0.05/length(sub.sites),max.plots=10)
ewas.summary &lt;- meffil.ewas.summary(ewas.sub.ret,
                                    beta,
                                    selected.cpg.sites=sub.sites,
                                    parameters=ewas.parameters, verbose=T)
</code></pre>

<pre><code>## [meffil.ewas.summary] Fri Jun 25 15:42:37 2021 QQ plots 
## [meffil.ewas.summary] Fri Jun 25 15:42:37 2021 Manhattan plots 
## [meffil.ewas.summary] Fri Jun 25 15:42:37 2021 CpG site plots: 100 
## [FUN] Fri Jun 25 15:42:37 2021 Plotting cg03526452 
## [FUN] Fri Jun 25 15:42:37 2021 Plotting cg05670219 
## [FUN] Fri Jun 25 15:42:37 2021 Plotting cg19479086 
## [FUN] Fri Jun 25 15:42:37 2021 Plotting cg15550234 
## [FUN] Fri Jun 25 15:42:37 2021 Plotting cg18221168 
## [FUN] Fri Jun 25 15:42:37 2021 Plotting cg23231163 
## [FUN] Fri Jun 25 15:42:37 2021 Plotting cg08450021 
## [FUN] Fri Jun 25 15:42:37 2021 Plotting cg23981172 
## [FUN] Fri Jun 25 15:42:37 2021 Plotting cg24930059 
## [FUN] Fri Jun 25 15:42:37 2021 Plotting cg04413147 
## [FUN] Fri Jun 25 15:42:37 2021 Plotting cg24437797 
## [FUN] Fri Jun 25 15:42:37 2021 Plotting cg10409327 
## [FUN] Fri Jun 25 15:42:37 2021 Plotting cg14935025 
## [FUN] Fri Jun 25 15:42:37 2021 Plotting cg10621374 
## [FUN] Fri Jun 25 15:42:37 2021 Plotting cg13780428 
## [FUN] Fri Jun 25 15:42:38 2021 Plotting cg02938179 
## [FUN] Fri Jun 25 15:42:38 2021 Plotting cg27035201 
## [FUN] Fri Jun 25 15:42:38 2021 Plotting cg10096321 
## [FUN] Fri Jun 25 15:42:38 2021 Plotting cg07451261 
## [FUN] Fri Jun 25 15:42:38 2021 Plotting cg24076965 
## [FUN] Fri Jun 25 15:42:38 2021 Plotting cg03395191 
## [FUN] Fri Jun 25 15:42:38 2021 Plotting cg24427243 
## [FUN] Fri Jun 25 15:42:38 2021 Plotting cg11176737 
## [FUN] Fri Jun 25 15:42:38 2021 Plotting cg07138491 
## [FUN] Fri Jun 25 15:42:38 2021 Plotting cg02932301 
## [FUN] Fri Jun 25 15:42:38 2021 Plotting cg07121807 
## [FUN] Fri Jun 25 15:42:38 2021 Plotting cg27223250 
## [FUN] Fri Jun 25 15:42:38 2021 Plotting cg27026405 
## [FUN] Fri Jun 25 15:42:38 2021 Plotting cg11525548 
## [FUN] Fri Jun 25 15:42:38 2021 Plotting cg00769843 
## [FUN] Fri Jun 25 15:42:38 2021 Plotting cg13454407 
## [FUN] Fri Jun 25 15:42:38 2021 Plotting cg26332253 
## [FUN] Fri Jun 25 15:42:38 2021 Plotting cg27024271 
## [FUN] Fri Jun 25 15:42:38 2021 Plotting cg25268718 
## [FUN] Fri Jun 25 15:42:38 2021 Plotting cg05315510 
## [FUN] Fri Jun 25 15:42:38 2021 Plotting cg04631994 
## [FUN] Fri Jun 25 15:42:38 2021 Plotting cg27062243 
## [FUN] Fri Jun 25 15:42:38 2021 Plotting cg05745461 
## [FUN] Fri Jun 25 15:42:39 2021 Plotting cg19353425 
## [FUN] Fri Jun 25 15:42:39 2021 Plotting cg06578434 
## [FUN] Fri Jun 25 15:42:39 2021 Plotting cg14801546 
## [FUN] Fri Jun 25 15:42:39 2021 Plotting cg00935887 
## [FUN] Fri Jun 25 15:42:39 2021 Plotting cg19800605 
## [FUN] Fri Jun 25 15:42:39 2021 Plotting cg08924343 
## [FUN] Fri Jun 25 15:42:39 2021 Plotting cg11747279 
## [FUN] Fri Jun 25 15:42:39 2021 Plotting cg14367513 
## [FUN] Fri Jun 25 15:42:39 2021 Plotting cg07226481 
## [FUN] Fri Jun 25 15:42:39 2021 Plotting cg05320271 
## [FUN] Fri Jun 25 15:42:39 2021 Plotting cg22848896 
## [FUN] Fri Jun 25 15:42:39 2021 Plotting cg10596006 
## [FUN] Fri Jun 25 15:42:39 2021 Plotting cg10170443 
## [FUN] Fri Jun 25 15:42:39 2021 Plotting cg23251248 
## [FUN] Fri Jun 25 15:42:39 2021 Plotting cg21793452 
## [FUN] Fri Jun 25 15:42:39 2021 Plotting cg04825215 
## [FUN] Fri Jun 25 15:42:39 2021 Plotting cg15899461 
## [FUN] Fri Jun 25 15:42:40 2021 Plotting cg07151443 
## [FUN] Fri Jun 25 15:42:40 2021 Plotting cg22869668 
## [FUN] Fri Jun 25 15:42:40 2021 Plotting cg17929951 
## [FUN] Fri Jun 25 15:42:40 2021 Plotting cg05864140 
## [FUN] Fri Jun 25 15:42:40 2021 Plotting cg17754473 
## [FUN] Fri Jun 25 15:42:40 2021 Plotting cg01522412 
## [FUN] Fri Jun 25 15:42:40 2021 Plotting cg23608075 
## [FUN] Fri Jun 25 15:42:40 2021 Plotting cg15649384 
## [FUN] Fri Jun 25 15:42:40 2021 Plotting cg16131578 
## [FUN] Fri Jun 25 15:42:40 2021 Plotting cg04485844 
## [FUN] Fri Jun 25 15:42:40 2021 Plotting cg25564121 
## [FUN] Fri Jun 25 15:42:40 2021 Plotting cg17903306 
## [FUN] Fri Jun 25 15:42:40 2021 Plotting cg06289824 
## [FUN] Fri Jun 25 15:42:40 2021 Plotting cg04422741 
## [FUN] Fri Jun 25 15:42:40 2021 Plotting cg03331695 
## [FUN] Fri Jun 25 15:42:40 2021 Plotting cg17650057 
## [FUN] Fri Jun 25 15:42:40 2021 Plotting cg25416319 
## [FUN] Fri Jun 25 15:42:40 2021 Plotting cg12121162 
## [FUN] Fri Jun 25 15:42:40 2021 Plotting cg02903305 
## [FUN] Fri Jun 25 15:42:40 2021 Plotting cg26587228 
## [FUN] Fri Jun 25 15:42:40 2021 Plotting cg01027519 
## [FUN] Fri Jun 25 15:42:40 2021 Plotting cg09816180 
## [FUN] Fri Jun 25 15:42:41 2021 Plotting cg20390826 
## [FUN] Fri Jun 25 15:42:41 2021 Plotting cg01586332 
## [FUN] Fri Jun 25 15:42:41 2021 Plotting cg24574111 
## [FUN] Fri Jun 25 15:42:41 2021 Plotting cg22856010 
## [FUN] Fri Jun 25 15:42:41 2021 Plotting cg10136240 
## [FUN] Fri Jun 25 15:42:41 2021 Plotting cg26373541 
## [FUN] Fri Jun 25 15:42:41 2021 Plotting cg26783057 
## [FUN] Fri Jun 25 15:42:41 2021 Plotting cg05228735 
## [FUN] Fri Jun 25 15:42:41 2021 Plotting cg02475408 
## [FUN] Fri Jun 25 15:42:41 2021 Plotting cg13010373 
## [FUN] Fri Jun 25 15:42:41 2021 Plotting cg13842648 
## [FUN] Fri Jun 25 15:42:41 2021 Plotting cg08355045 
## [FUN] Fri Jun 25 15:42:41 2021 Plotting cg07516091 
## [FUN] Fri Jun 25 15:42:41 2021 Plotting cg20946369 
## [FUN] Fri Jun 25 15:42:41 2021 Plotting cg02099233 
## [FUN] Fri Jun 25 15:42:41 2021 Plotting cg00473639 
## [FUN] Fri Jun 25 15:42:41 2021 Plotting cg19639071 
## [FUN] Fri Jun 25 15:42:41 2021 Plotting cg21087260 
## [FUN] Fri Jun 25 15:42:42 2021 Plotting cg00375444 
## [FUN] Fri Jun 25 15:42:42 2021 Plotting cg10245797 
## [FUN] Fri Jun 25 15:42:42 2021 Plotting cg15017007 
## [FUN] Fri Jun 25 15:42:42 2021 Plotting cg08339762 
## [FUN] Fri Jun 25 15:42:42 2021 Plotting cg03413884 
## [meffil.ewas.summary] Fri Jun 25 15:42:42 2021 Sample characteristics 
## [meffil.ewas.sample.characteristics] Fri Jun 25 15:42:42 2021 summarizing variables 
## [summarize.variable] Fri Jun 25 15:42:42 2021 variable of interest 
## [summarize.variable] Fri Jun 25 15:42:42 2021 Bcell 
## [summarize.variable] Fri Jun 25 15:42:42 2021 CD14 
## [summarize.variable] Fri Jun 25 15:42:42 2021 CD4T 
## [summarize.variable] Fri Jun 25 15:42:42 2021 CD8T 
## [summarize.variable] Fri Jun 25 15:42:42 2021 Gran 
## [summarize.variable] Fri Jun 25 15:42:42 2021 NK 
## [summarize.variable] Fri Jun 25 15:42:42 2021 socioeconomic.score 
## [summarize.variable] Fri Jun 25 15:42:42 2021 gender 
## [summarize.variable] Fri Jun 25 15:42:42 2021 smoke.ever 
## [summarize.variable] Fri Jun 25 15:42:42 2021 birth.weight 
## [summarize.variable] Fri Jun 25 15:42:42 2021 X1 
## [summarize.variable] Fri Jun 25 15:42:42 2021 X2 
## [summarize.variable] Fri Jun 25 15:42:42 2021 X3 
## [summarize.variable] Fri Jun 25 15:42:42 2021 X4 
## [summarize.variable] Fri Jun 25 15:42:42 2021 X5 
## [summarize.variable] Fri Jun 25 15:42:42 2021 X6 
## [summarize.variable] Fri Jun 25 15:42:42 2021 X7 
## [summarize.variable] Fri Jun 25 15:42:42 2021 X8 
## [summarize.variable] Fri Jun 25 15:42:42 2021 X9 
## [summarize.variable] Fri Jun 25 15:42:42 2021 X10 
## [summarize.variable] Fri Jun 25 15:42:42 2021 X11 
## [summarize.variable] Fri Jun 25 15:42:42 2021 X12 
## [summarize.variable] Fri Jun 25 15:42:42 2021 X13 
## [summarize.variable] Fri Jun 25 15:42:42 2021 X14 
## [summarize.variable] Fri Jun 25 15:42:42 2021 X15 
## [summarize.variable] Fri Jun 25 15:42:42 2021 X16 
## [summarize.variable] Fri Jun 25 15:42:42 2021 X17 
## [summarize.variable] Fri Jun 25 15:42:42 2021 X18 
## [summarize.variable] Fri Jun 25 15:42:42 2021 X19 
## [summarize.variable] Fri Jun 25 15:42:42 2021 X20 
## [summarize.variable] Fri Jun 25 15:42:42 2021 X21 
## [summarize.variable] Fri Jun 25 15:42:42 2021 X22 
## [summarize.variable] Fri Jun 25 15:42:42 2021 X23 
## [summarize.variable] Fri Jun 25 15:42:42 2021 X24 
## [summarize.variable] Fri Jun 25 15:42:42 2021 X25 
## [summarize.variable] Fri Jun 25 15:42:42 2021 X26 
## [summarize.variable] Fri Jun 25 15:42:42 2021 X27 
## [meffil.ewas.covariate.associations] Fri Jun 25 15:42:42 2021 covariate associations 
## [FUN] Fri Jun 25 15:42:42 2021 Bcell 
## [FUN] Fri Jun 25 15:42:42 2021 CD14 
## [FUN] Fri Jun 25 15:42:42 2021 CD4T 
## [FUN] Fri Jun 25 15:42:42 2021 CD8T 
## [FUN] Fri Jun 25 15:42:42 2021 Gran 
## [FUN] Fri Jun 25 15:42:42 2021 NK 
## [FUN] Fri Jun 25 15:42:42 2021 socioeconomic.score 
## [FUN] Fri Jun 25 15:42:42 2021 gender 
## [FUN] Fri Jun 25 15:42:42 2021 smoke.ever 
## [FUN] Fri Jun 25 15:42:42 2021 birth.weight 
## [FUN] Fri Jun 25 15:42:42 2021 X1 
## [FUN] Fri Jun 25 15:42:42 2021 X2 
## [FUN] Fri Jun 25 15:42:42 2021 X3 
## [FUN] Fri Jun 25 15:42:42 2021 X4 
## [FUN] Fri Jun 25 15:42:42 2021 X5 
## [FUN] Fri Jun 25 15:42:42 2021 X6 
## [FUN] Fri Jun 25 15:42:42 2021 X7 
## [FUN] Fri Jun 25 15:42:42 2021 X8 
## [FUN] Fri Jun 25 15:42:42 2021 X9 
## [FUN] Fri Jun 25 15:42:42 2021 X10 
## [FUN] Fri Jun 25 15:42:42 2021 X11 
## [FUN] Fri Jun 25 15:42:42 2021 X12 
## [FUN] Fri Jun 25 15:42:42 2021 X13 
## [FUN] Fri Jun 25 15:42:42 2021 X14 
## [FUN] Fri Jun 25 15:42:42 2021 X15 
## [FUN] Fri Jun 25 15:42:42 2021 X16 
## [FUN] Fri Jun 25 15:42:42 2021 X17 
## [FUN] Fri Jun 25 15:42:42 2021 X18 
## [FUN] Fri Jun 25 15:42:42 2021 X19 
## [FUN] Fri Jun 25 15:42:42 2021 X20 
## [FUN] Fri Jun 25 15:42:42 2021 X21 
## [FUN] Fri Jun 25 15:42:42 2021 X22 
## [FUN] Fri Jun 25 15:42:42 2021 X23 
## [FUN] Fri Jun 25 15:42:42 2021 X24 
## [FUN] Fri Jun 25 15:42:42 2021 X25 
## [FUN] Fri Jun 25 15:42:42 2021 X26 
## [FUN] Fri Jun 25 15:42:42 2021 X27
</code></pre>

<pre><code class="r">meffil.ewas.report(ewas.summary,
                   output.file=&quot;ewas/ewas-gestational-age-report-100.html&quot;,
                   author=ewas.author,
                   study=ewas.study)
</code></pre>

<pre><code>## [meffil.ewas.report] Fri Jun 25 15:42:42 2021 Writing report as html file to ewas/ewas-gestational-age-report-100.html
</code></pre>

<p>How well does SVA capture batch effects
that are not explicitly included in the model?</p>

<pre><code class="r">slide &lt;- model.matrix(~ 0 + Slide, samplesheet)
row &lt;- model.matrix(~ 0 + sentrix_row, samplesheet)

sv &lt;- ewas.ret$analyses$smartsva$design
sv &lt;- sv[,grep(&quot;X&quot;, colnames(sv))]

library(penalized)

prediction.accuracy &lt;- function(v, p) {
    fit &lt;- optL1(response=v, penalized=p, fold=10, standardize=T, maxiter=1000, model=&quot;logistic&quot;)
    sum((fit$predictions &gt; 0.5) == (v == 1))/length(v)
}

apply(row, 2, prediction.accuracy, sv)
</code></pre>

<pre><code>## lambda= 4.3011   12345678910cvl= -23.3911 
## lambda= 6.959325     12345678910cvl= -28.97013 
## lambda= 2.658226     12345678910cvl= -17.95161 
## lambda= 1.642874     12345678910cvl= -14.4054 
## lambda= 1.015352     12345678910cvl= -12.45508 
## lambda= 0.627522     12345678910cvl= -11.56866 
## lambda= 0.3878299    12345678910cvl= -11.11156 
## lambda= 0.2396921    12345678910cvl= -11.04706 
## lambda= 0.256389     12345678910cvl= -11.0275 
## lambda= 0.2959573    12345678910cvl= -11.03092 
## lambda= 0.2715027    12345678910cvl= -11.03245 
## lambda= 0.2500113    12345678910cvl= -11.03314 
## lambda= 0.2621619    12345678910cvl= -11.03041 
## lambda= 0.2539529    12345678910cvl= -11.02949 
## lambda= 0.2577096    12345678910cvl= -11.0279 
## lambda= 0.2565378    12345678910cvl= -11.02738 
## lambda= 0.2568835    12345678910cvl= -11.02749 
## lambda= 0.2566698    12345678910cvl= -11.02739 
## lambda= 0.2565906    12345678910cvl= -11.02735 
## lambda= 0.2566018    12345678910cvl= -11.02736 
## lambda= 0.8328221    12345678910cvl= -11.75584 
## lambda= 1.347534     12345678910cvl= -9.520796 
## lambda= 1.665644     12345678910cvl= -9.316869 
## lambda= 1.578712     12345678910cvl= -9.366886 
## lambda= 1.862247     12345678910cvl= -9.27885 
## lambda= 1.835716     12345678910cvl= -9.276347 
## lambda= 1.821094     12345678910cvl= -9.275871 
## lambda= 1.817592     12345678910cvl= -9.275807 
## lambda= 1.759553     12345678910cvl= -9.283873 
## lambda= 1.807465     12345678910cvl= -9.27616 
## lambda= 1.816987     12345678910cvl= -9.275797 
## lambda= 1.81335  12345678910cvl= -9.275754 
## lambda= 1.811103     12345678910cvl= -9.275797 
## lambda= 1.814032     12345678910cvl= -9.275761 
## lambda= 1.813198     12345678910cvl= -9.275753 
## lambda= 1.812398     12345678910cvl= -9.275746 
## lambda= 1.811903     12345678910cvl= -9.275743 
## lambda= 1.811597     12345678910cvl= -9.275749 
## lambda= 1.811997     12345678910cvl= -9.275743 
## lambda= 4.117241     12345678910cvl= -31.22126 
## lambda= 6.661836     12345678910cvl= -31.88978 
## lambda= 2.544595     12345678910cvl= -27.35457 
## lambda= 1.572646     12345678910cvl= -25.86322 
## lambda= 0.9719488    12345678910cvl= -25.21126 
## lambda= 0.6006974    12345678910cvl= -25.56354 
## lambda= 1.01301  12345678910cvl= -25.25087 
## lambda= 0.8885609    12345678910cvl= -25.11046 
## lambda= 0.7786068    12345678910cvl= -25.13635 
## lambda= 0.849348     12345678910cvl= -25.08981 
## lambda= 0.8445164    12345678910cvl= -25.08828 
## lambda= 0.8193412    12345678910cvl= -25.087 
## lambda= 0.8290385    12345678910cvl= -25.08426 
## lambda= 0.8307447    12345678910cvl= -25.08389 
## lambda= 0.836005     12345678910cvl= -25.08326 
## lambda= 0.8374967    12345678910cvl= -25.08491 
## lambda= 0.8341207    12345678910cvl= -25.08324 
## lambda= 0.8328312    12345678910cvl= -25.08347 
## lambda= 0.8349729    12345678910cvl= -25.0831 
## lambda= 0.8350317    12345678910cvl= -25.08309 
## lambda= 0.8354034    12345678910cvl= -25.08303 
## lambda= 0.8356332    12345678910cvl= -25.08299 
## lambda= 0.8357752    12345678910cvl= -25.08301 
## lambda= 0.8355893    12345678910cvl= -25.083 
## lambda= 1.585877     12345678910cvl= -8.785944 
## lambda= 2.566003     12345678910cvl= -8.971841 
## lambda= 0.980126     12345678910cvl= -8.406465 
## lambda= 0.6057512    12345678910cvl= -8.198009 
## lambda= 0.3743748    12345678910cvl= -8.176113 
## lambda= 0.4280486    12345678910cvl= -8.163216 
## lambda= 0.4649568    12345678910cvl= -8.164802 
## lambda= 0.4396336    12345678910cvl= -8.162893 
## lambda= 0.4388294    12345678910cvl= -8.16289 
## lambda= 0.4386328    12345678910cvl= -8.16289 
## lambda= 0.4386225    12345678910cvl= -8.162885 
## lambda= 0.4345836    12345678910cvl= -8.162937 
## lambda= 0.4370798    12345678910cvl= -8.162897 
## lambda= 0.4380333    12345678910cvl= -8.162891 
## lambda= 0.4383975    12345678910cvl= -8.16289 
## lambda= 0.4385366    12345678910cvl= -8.16289
</code></pre>

<pre><code>## sentrix_row01 sentrix_row02 sentrix_row04 sentrix_row05 
##     0.8636364     0.9545455     0.6818182     0.9545455
</code></pre>

<pre><code class="r">apply(slide, 2, prediction.accuracy, sv)
</code></pre>

<pre><code>## lambda= 2.164059     12345678910cvl= -12.01604 
## lambda= 3.501521     12345678910cvl= -13.87578 
## lambda= 1.337462     12345678910cvl= -9.589138 
## lambda= 0.8265969    12345678910cvl= -7.884368 
## lambda= 0.510865     12345678910cvl= -6.805264 
## lambda= 0.3157319    12345678910cvl= -6.066374 
## lambda= 0.1951331    12345678910cvl= -5.471074 
## lambda= 0.1205989    12345678910cvl= -5.125082 
## lambda= 0.0745342    12345678910cvl= -4.900119 
## lambda= 0.04606467   12345678910cvl= -4.718098 
## lambda= 0.02846953   12345678910cvl= -4.579822 
## lambda= 0.01759514   12345678910cvl= -4.48959 
## lambda= 0.01087439   12345678910cvl= -4.41198 
## lambda= 0.006720745  12345678910cvl= -4.365727 
## lambda= 0.004153649  12345678910cvl= -4.357028 
## lambda= 0.003967237  12345678910cvl= -4.357915 
## lambda= 0.004864608  12345678910cvl= -4.355976 
## lambda= 0.005573589  123456789cvl= -Inf 
## lambda= 0.004711679  12345678910cvl= -4.355921 
## lambda= 0.004733882  12345678910cvl= -4.355918 
## lambda= 0.004739613  12345678910cvl= -4.355918 
## lambda= 0.004744442  12345678910cvl= -4.355918 
## lambda= 0.004744488  12345678910cvl= -4.355925 
## lambda= 0.00474205   12345678910cvl= -4.355918 
## lambda= 0.004743528  12345678910cvl= -4.355918 
## lambda= 1.917086     12345678910cvl= -15.54619 
## lambda= 3.101911     12345678910cvl= -14.37161 
## lambda= 3.834172     12345678910cvl= -14.26544 
## lambda= 3.632237     12345678910cvl= -14.26287 
## lambda= 3.711802     12345678910cvl= -14.26891 
## lambda= 3.42967  12345678910cvl= -14.24501 
## lambda= 3.304477     12345678910cvl= -14.25578 
## lambda= 3.448015     12345678910cvl= -14.24563 
## lambda= 3.418437     12345678910cvl= -14.24435 
## lambda= 3.374908     12345678910cvl= -14.24131 
## lambda= 3.348006     12345678910cvl= -14.2383 
## lambda= 3.331379     12345678910cvl= -14.24183 
## lambda= 3.353939     12345678910cvl= -14.23895 
## lambda= 3.341655     12345678910cvl= -14.23762 
## lambda= 3.33773  12345678910cvl= -14.23858 
## lambda= 3.343264     12345678910cvl= -14.23779 
## lambda= 3.340156     12345678910cvl= -14.23747 
## lambda= 3.339229     12345678910cvl= -14.23782 
## lambda= 3.340729     12345678910cvl= -14.23753 
## lambda= 3.339802     12345678910cvl= -14.23752 
## lambda= 2.306193     12345678910cvl= -18.14455 
## lambda= 3.731499     12345678910cvl= -16.57918 
## lambda= 4.612386     12345678910cvl= -15.32848 
## lambda= 5.156805     12345678910cvl= -14.83211 
## lambda= 5.493274     12345678910cvl= -14.60539 
## lambda= 5.701223     12345678910cvl= -14.46664 
## lambda= 5.829743     12345678910cvl= -14.38153 
## lambda= 5.909172     12345678910cvl= -14.32921 
## lambda= 5.958262     12345678910cvl= -14.297 
## lambda= 5.988602     12345678910cvl= -14.27715 
## lambda= 6.007353     12345678910cvl= -14.26489 
## lambda= 6.018941     12345678910cvl= -14.25733 
## lambda= 6.026103     12345678910cvl= -14.25266 
## lambda= 6.03053  12345678910cvl= -14.24977 
## lambda= 6.033266     12345678910cvl= -14.24799 
## lambda= 6.034956     12345678910cvl= -14.24689 
## lambda= 6.036001     12345678910cvl= -14.24621 
## lambda= 6.036647     12345678910cvl= -14.24579 
## lambda= 2.369236     12345678910cvl= -12.02679 
## lambda= 3.833505     12345678910cvl= -13.91827 
## lambda= 1.464269     12345678910cvl= -11.68266 
## lambda= 1.42254  12345678910cvl= -11.67462 
## lambda= 0.8791779    12345678910cvl= -12.34363 
## lambda= 0.9575857    12345678910cvl= -12.07635 
## lambda= 1.244943     12345678910cvl= -11.67534 
## lambda= 1.336022     12345678910cvl= -11.67303 
## lambda= 1.342051     12345678910cvl= -11.67368 
## lambda= 1.301233     12345678910cvl= -11.67264 
## lambda= 1.316199     12345678910cvl= -11.67206 
## lambda= 1.316384     12345678910cvl= -11.67205 
## lambda= 1.323885     12345678910cvl= -11.67188 
## lambda= 1.328521     12345678910cvl= -11.6723 
## lambda= 1.32102  12345678910cvl= -11.67193 
## lambda= 1.325656     12345678910cvl= -11.67203 
## lambda= 1.322879     12345678910cvl= -11.6719 
## lambda= 1.324561     12345678910cvl= -11.67194 
## lambda= 1.323501     12345678910cvl= -11.67188 
## lambda= 1.324143     12345678910cvl= -11.6719 
## lambda= 1.323738     12345678910cvl= -11.67188 
## lambda= 1.868523     12345678910cvl= -16.76177 
## lambda= 3.023334     12345678910cvl= -15.5355 
## lambda= 3.737047     12345678910cvl= -15.20603 
## lambda= 4.098728     12345678910cvl= -15.19677 
## lambda= 3.949453     12345678910cvl= -15.18914 
## lambda= 3.953336     12345678910cvl= -15.18915 
## lambda= 3.949398     12345678910cvl= -15.18914 
## lambda= 3.951317     12345678910cvl= -15.18908 
## lambda= 3.952088     12345678910cvl= -15.18909 
## lambda= 3.95077  12345678910cvl= -15.1891 
## lambda= 1.534688     12345678910cvl= -14.6659 
## lambda= 2.483178     12345678910cvl= -13.93475 
## lambda= 3.069377     12345678910cvl= -14.14861 
## lambda= 2.529771     12345678910cvl= -13.98244 
## lambda= 2.120887     12345678910cvl= -13.71367 
## lambda= 2.000294     12345678910cvl= -13.70378 
## lambda= 2.023105     12345678910cvl= -13.69972 
## lambda= 2.045178     12345678910cvl= -13.69693 
## lambda= 2.074096     12345678910cvl= -13.69717 
## lambda= 2.058032     12345678910cvl= -13.69581 
## lambda= 2.05892  12345678910cvl= -13.69575 
## lambda= 2.064717     12345678910cvl= -13.69538 
## lambda= 2.068299     12345678910cvl= -13.69547 
## lambda= 2.065184     12345678910cvl= -13.69536 
## lambda= 2.06603  12345678910cvl= -13.69531 
## lambda= 2.066897     12345678910cvl= -13.69526 
## lambda= 2.067433     12345678910cvl= -13.69524 
## lambda= 2.067764     12345678910cvl= -13.69532 
## lambda= 2.067228     12345678910cvl= -13.69525 
## lambda= 1.316376     12345678910cvl= -14.65583 
## lambda= 2.129941     12345678910cvl= -13.99944 
## lambda= 2.632751     12345678910cvl= -13.72245 
## lambda= 2.943506     12345678910cvl= -13.46397 
## lambda= 3.135562     12345678910cvl= -13.35415 
## lambda= 3.25426  12345678910cvl= -13.29987 
## lambda= 3.327619     12345678910cvl= -13.28073 
## lambda= 3.418435     12345678910cvl= -13.26121 
## lambda= 3.383746     12345678910cvl= -13.26863 
## lambda= 3.405185     12345678910cvl= -13.26404 
## lambda= 3.429085     12345678910cvl= -13.25956 
## lambda= 3.435667     12345678910cvl= -13.25879 
## lambda= 3.439734     12345678910cvl= -13.25831 
## lambda= 3.442249     12345678910cvl= -13.25802 
## lambda= 3.443802     12345678910cvl= -13.25784 
## lambda= 3.444763     12345678910cvl= -13.25772 
## lambda= 3.445356     12345678910cvl= -13.25766 
## lambda= 3.445723     12345678910cvl= -13.25761 
## lambda= 2.022054     12345678910cvl= -12.55919 
## lambda= 3.271752     12345678910cvl= -14.52993 
## lambda= 1.249698     12345678910cvl= -12.5477 
## lambda= 1.626248     12345678910cvl= -12.34372 
## lambda= 1.630586     12345678910cvl= -12.34427 
## lambda= 1.592663     12345678910cvl= -12.34203 
## lambda= 1.461662     12345678910cvl= -12.40242 
## lambda= 1.596681     12345678910cvl= -12.34031 
## lambda= 1.6079   12345678910cvl= -12.341 
## lambda= 1.600966     12345678910cvl= -12.33966 
## lambda= 1.601285     12345678910cvl= -12.33973 
## lambda= 1.599715     12345678910cvl= -12.33936 
## lambda= 1.598556     12345678910cvl= -12.33943 
## lambda= 1.599374     12345678910cvl= -12.33928 
## lambda= 1.599217     12345678910cvl= -12.33924 
## lambda= 1.598964     12345678910cvl= -12.33924 
## lambda= 1.598886     12345678910cvl= -12.33925 
## lambda= 0.7962483    12345678910cvl= -32.32967 
## lambda= 1.288357     12345678910cvl= -33.25302 
## lambda= 0.4921085    12345678910cvl= -34.29124 
## lambda= 0.952582     12345678910cvl= -35.33652 
## lambda= 0.6800772    12345678910cvl= -36.3205 
## lambda= 0.8559625    12345678910cvl= -37.33353 
## lambda= 0.7518749    12345678910cvl= -38.32668 
## lambda= 0.8190571    12345678910cvl= -39.33117 
## lambda= 0.7792992    12345678910cvl= -40.32854 
## lambda= 0.8049605    12345678910cvl= -41.33025 
## lambda= 0.7897743    12345678910cvl= -42.32924 
## lambda= 0.7995761    12345678910cvl= -43.32989 
## lambda= 0.7937755    12345678910cvl= -44.32951 
## lambda= 0.7975194    12345678910cvl= -45.32976 
## lambda= 0.7953038    12345678910cvl= -46.32961 
## lambda= 0.7967338    12345678910cvl= -47.3297 
## lambda= 0.7958875    12345678910cvl= -48.32965 
## lambda= 0.7964338    12345678910cvl= -49.32968 
## lambda= 0.7961105    12345678910cvl= -50.32966 
## lambda= 0.9853291    12345678910cvl= -10.27625 
## lambda= 1.594296     12345678910cvl= -9.759865 
## lambda= 1.970658     12345678910cvl= -9.440561 
## lambda= 2.203263     12345678910cvl= -9.382502 
## lambda= 2.213883     12345678910cvl= -9.380734 
## lambda= 2.353584     12345678910cvl= -9.36752 
## lambda= 2.382654     12345678910cvl= -9.368172 
## lambda= 2.351945     12345678910cvl= -9.367484 
## lambda= 2.29921  12345678910cvl= -9.371242 
## lambda= 2.331802     12345678910cvl= -9.368564 
## lambda= 2.344251     12345678910cvl= -9.367555 
## lambda= 2.349492     12345678910cvl= -9.367431 
## lambda= 2.34749  12345678910cvl= -9.367388 
## lambda= 2.346253     12345678910cvl= -9.367394 
## lambda= 2.347143     12345678910cvl= -9.367381 
## lambda= 2.346872     12345678910cvl= -9.367375 
## lambda= 2.346635     12345678910cvl= -9.36737 
## lambda= 1.187451     12345678910cvl= -9.999043 
## lambda= 1.921336     12345678910cvl= -9.55212 
## lambda= 2.374902     12345678910cvl= -9.535464 
## lambda= 2.186218     12345678910cvl= -9.534576 
## lambda= 2.265508     12345678910cvl= -9.530198 
## lambda= 2.276262     12345678910cvl= -9.529524 
## lambda= 2.313939     12345678910cvl= -9.530137 
## lambda= 2.290109     12345678910cvl= -9.528786 
## lambda= 2.292311     12345678910cvl= -9.528876 
## lambda= 2.287732     12345678910cvl= -9.528903 
## lambda= 2.290169     12345678910cvl= -9.528784 
## lambda= 2.290718     12345678910cvl= -9.528796 
## lambda= 2.823262     12345678910cvl= -8.53674 
## lambda= 4.568134     12345678910cvl= -11.7372 
## lambda= 1.744872     12345678910cvl= -8.027123 
## lambda= 1.794143     12345678910cvl= -8.042032 
## lambda= 1.07839  12345678910cvl= -6.812412 
## lambda= 0.6664817    12345678910cvl= -5.85845 
## lambda= 0.4119083    12345678910cvl= -5.070973 
## lambda= 0.2545734    12345678910cvl= -4.516736 
## lambda= 0.157335     12345678910cvl= -4.157195 
## lambda= 0.09723837   12345678910cvl= -3.911418 
## lambda= 0.06009662   12345678910cvl= -3.749631 
## lambda= 0.03714175   12345678910cvl= -3.627484 
## lambda= 0.02295487   12345678910cvl= -3.556805 
## lambda= 0.01418689   12345678910cvl= -3.518728 
## lambda= 0.008767978  12345678910cvl= -3.506075 
## lambda= 0.003227091  12345678910cvl= -3.541064 
## lambda= 0.00999809   12345678910cvl= -3.507314 
## lambda= 0.007794092  12345678910cvl= -3.506259 
## lambda= 0.00845534   12345678910cvl= -3.506004 
## lambda= 0.008431669  12345678910cvl= -3.506003 
## lambda= 0.008419177  12345678910cvl= -3.506003 
## lambda= 0.008420013  12345678910cvl= -3.506003 
## lambda= 0.008425423  12345678910cvl= -3.506003 
## lambda= 0.00842208   12345678910cvl= -3.506003 
## lambda= 0.008420628  12345678910cvl= -3.506003 
## lambda= 2.102541     12345678910cvl= -11.29625 
## lambda= 3.401983     12345678910cvl= -13.72075 
## lambda= 1.299442     12345678910cvl= -9.553878 
## lambda= 0.8030993    12345678910cvl= -8.286422 
## lambda= 0.4963427    12345678910cvl= -7.639522 
## lambda= 0.3067567    12345678910cvl= -7.435546 
## lambda= 0.1430545    12345678910cvl= -7.347797 
## lambda= 0.04952041   12345678910cvl= -7.52917 
## lambda= 0.1970515    12345678910cvl= -7.346587 
## lambda= 0.1722544    12345678910cvl= -7.344297 
## lambda= 0.1729042    12345678910cvl= -7.344274 
## lambda= 0.1759287    12345678910cvl= -7.34423 
## lambda= 0.1756938    12345678910cvl= -7.34423 
## lambda= 0.175704     12345678910cvl= -7.34423 
## lambda= 0.1758112    12345678910cvl= -7.34423 
## lambda= 0.1757449    12345678910cvl= -7.34423
</code></pre>

<pre><code>## Slide5815073001 Slide5815073007 Slide5815073008 Slide5815073009 Slide5815073011 
##       0.9545455       0.9090909       0.9090909       0.9090909       0.9090909 
## Slide5815073012 Slide5815073020 Slide5815073029 Slide5815129020 Slide5815129025 
##       0.9090909       0.9318182       0.9090909       0.9772727       0.9545455 
## Slide5815129026 Slide5815233016 Slide5815233019 
##       0.9545455       0.9772727       0.9318182
</code></pre>

<p>How much do the different EWAS models agree?</p>

<pre><code class="r">sapply(ewas.ret$analyses, function(a) 
       sapply(ewas.ret$analyses, function(b) 
              length(intersect(rownames(a$table)[which(a$table$p.value &lt; 0.0001)],
                               rownames(b$table)[which(b$table$p.value &lt; 0.0001)]))))
</code></pre>

<pre><code>##          none all smartsva
## none       87   7        0
## all         7  41        0
## smartsva    0   0       48
</code></pre>

<pre><code class="r">sapply(ewas.ret$analyses, function(a) 
       sapply(ewas.ret$analyses, function(b) {
           a &lt;- rownames(a$table)[which(a$table$p.value &lt; 0.0001)]
           b &lt;- rownames(b$table)[which(b$table$p.value &lt; 0.0001)]
           length(intersect(a,b))/length(union(a,b))
       }))
</code></pre>

<pre><code>##                none        all smartsva
## none     1.00000000 0.05785124        0
## all      0.05785124 1.00000000        0
## smartsva 0.00000000 0.00000000        1
</code></pre>

<pre><code class="r">sapply(ewas.ret$analyses, function(a) 
       sapply(ewas.ret$analyses, function(b) {
           idx &lt;- which(a$table$p.value &lt; 0.01)
           cor(a$table$coefficient[idx], b$table$coefficient[idx])
       }))
</code></pre>

<pre><code>##               none       all  smartsva
## none     1.0000000 0.9219939 0.4973972
## all      0.9195526 1.0000000 0.6830018
## smartsva 0.5413078 0.7394905 1.0000000
</code></pre>

<p>Compare meffil EWAS to EWAS &#39;done by hand&#39;.</p>

<pre><code class="r">## EWAS by meffil
test.ret &lt;- meffil.ewas(beta,
                        variable=variable,
                        covariates=covariates,
                        isva=F,sva=T,smartsva=F,
                        most.variable=50000,
                        random.seed=20161123,
                        verbose=T)
</code></pre>

<pre><code>## [meffil.ewas] Fri Jun 25 15:45:39 2021 Simplifying any categorical variables. 
## [meffil.ewas] Fri Jun 25 15:45:39 2021 Removing 0 missing case(s). 
## [meffil.ewas] Fri Jun 25 15:45:39 2021 Removing 0 covariates with no variance. 
## [meffil.ewas] Fri Jun 25 15:45:39 2021 Computing surrogate variables ... 
## [add.surrogate.variables] Fri Jun 25 15:45:40 2021 Calculating CpG variance 
## [add.surrogate.variables] Fri Jun 25 15:46:03 2021 SVA. 
## Number of significant surrogate variables is:  7 
## Iteration (out of 5 ):1  2  3  4  5  
## [meffil.ewas] Fri Jun 25 15:46:35 2021 Starting EWAS ... 
## [:::] [meffil] [ewas.by.matrix] Fri Jun 25 15:46:35 2021 Handling methylation outliers 
## [FUN] Fri Jun 25 15:46:57 2021 EWAS for covariate set none 
## [:::] [meffil] [ewas.limma] Fri Jun 25 15:46:57 2021 Linear regression with limma::lmFit 
## [:::] [meffil] [ewas.limma] Fri Jun 25 15:46:57 2021 Linear regression with only fixed effects 
## [:::] [meffil] [ewas.limma] Fri Jun 25 15:46:59 2021 Empirical Bayes 
## [FUN] Fri Jun 25 15:47:05 2021 EWAS for covariate set all 
## [:::] [meffil] [ewas.limma] Fri Jun 25 15:47:05 2021 Linear regression with limma::lmFit 
## [:::] [meffil] [ewas.limma] Fri Jun 25 15:47:05 2021 Linear regression with only fixed effects 
## [:::] [meffil] [ewas.limma] Fri Jun 25 15:47:10 2021 Empirical Bayes 
## [FUN] Fri Jun 25 15:47:20 2021 EWAS for covariate set sva 
## [:::] [meffil] [ewas.limma] Fri Jun 25 15:47:20 2021 Linear regression with limma::lmFit 
## [:::] [meffil] [ewas.limma] Fri Jun 25 15:47:20 2021 Linear regression with only fixed effects 
## [:::] [meffil] [ewas.limma] Fri Jun 25 15:47:25 2021 Empirical Bayes 
## [meffil.ewas] Fri Jun 25 15:47:40 2021 Finished EWAS.
</code></pre>

<pre><code class="r">test.ret$sv &lt;- test.ret$analyses$sva$design
test.ret$sv &lt;- test.ret$sv[,grep(&quot;X&quot;, colnames(test.ret$sv))]

## EWAS by hand
beta.win &lt;- meffil:::winsorize(beta)
beta.sva &lt;- beta.win
beta.sva &lt;- beta.sva[which(rownames(beta.sva) %in% meffil.get.autosomal.sites()),]
beta.sva &lt;- beta.sva[order(rowVars(beta.sva), decreasing=T)[1:50000],]
mod0 &lt;- model.matrix(~ ., covariates)
mod &lt;- cbind(mod0, variable)
set.seed(20161123)
sva.ret &lt;- sva(dat=beta.sva, mod=mod, mod0=mod0)
</code></pre>

<pre><code>## Number of significant surrogate variables is:  7 
## Iteration (out of 5 ):1  2  3  4  5
</code></pre>

<pre><code class="r">apply(abs(cor(test.ret$sv, sva.ret$sv)), 2, max)
</code></pre>

<pre><code>## [1] 1 1 1 1 1 1 1
</code></pre>

<pre><code class="r">mod &lt;- cbind(mod, sva.ret$sv)
fit &lt;- lm.fit(mod, t(beta.win))

cor(fit$coefficients[&quot;variable&quot;,], test.ret$analyses$sva$table$coefficient)
</code></pre>

<pre><code>## [1] 1
</code></pre>

<p>View EWAS effect estimates next to genes and other genomic landmarks
by generating genome browser tracks and uploading them
to <a href="https://genome.ucsc.edu/cgi-bin/hgCustom">https://genome.ucsc.edu/cgi-bin/hgCustom</a>.</p>

<pre><code class="r">meffil.ewas.bedgraph(ewas.ret, &quot;ewas/sva.bed&quot;, &quot;smartsva&quot;, name=&quot;ga&quot;, description=ewas.study)
header &lt;- paste0(&quot;track type=bedGraph name=&#39;ga-custom&#39; description=&#39;&quot;,
                 ewas.study,
                 &quot;&#39; visibility=full color=200,100,0 altColor=0,100,200 priority=20&quot;)
meffil.ewas.bedgraph(ewas.ret, &quot;ewas/sva-custom.bed&quot;, &quot;smartsva&quot;, header=header)
meffil.ewas.bedgraph(ewas.ret, &quot;ewas/sva-minimal.bed&quot;, &quot;smartsva&quot;)                    
</code></pre>

</body>

</html>
