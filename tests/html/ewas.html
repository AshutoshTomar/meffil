<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

<title>EWAS in meffil</title>

<script type="text/javascript">
window.onload = function() {
  var imgs = document.getElementsByTagName('img'), i, img;
  for (i = 0; i < imgs.length; i++) {
    img = imgs[i];
    // center an image if it is the only element of its parent
    if (img.parentElement.childElementCount === 1)
      img.parentElement.style.textAlign = 'center';
  }
};
</script>

<!-- Styles for R syntax highlighter -->
<style type="text/css">
   pre .operator,
   pre .paren {
     color: rgb(104, 118, 135)
   }

   pre .literal {
     color: #990073
   }

   pre .number {
     color: #099;
   }

   pre .comment {
     color: #998;
     font-style: italic
   }

   pre .keyword {
     color: #900;
     font-weight: bold
   }

   pre .identifier {
     color: rgb(0, 0, 0);
   }

   pre .string {
     color: #d14;
   }
</style>

<!-- R syntax highlighter -->
<script type="text/javascript">
var hljs=new function(){function m(p){return p.replace(/&/gm,"&amp;").replace(/</gm,"&lt;")}function f(r,q,p){return RegExp(q,"m"+(r.cI?"i":"")+(p?"g":""))}function b(r){for(var p=0;p<r.childNodes.length;p++){var q=r.childNodes[p];if(q.nodeName=="CODE"){return q}if(!(q.nodeType==3&&q.nodeValue.match(/\s+/))){break}}}function h(t,s){var p="";for(var r=0;r<t.childNodes.length;r++){if(t.childNodes[r].nodeType==3){var q=t.childNodes[r].nodeValue;if(s){q=q.replace(/\n/g,"")}p+=q}else{if(t.childNodes[r].nodeName=="BR"){p+="\n"}else{p+=h(t.childNodes[r])}}}if(/MSIE [678]/.test(navigator.userAgent)){p=p.replace(/\r/g,"\n")}return p}function a(s){var r=s.className.split(/\s+/);r=r.concat(s.parentNode.className.split(/\s+/));for(var q=0;q<r.length;q++){var p=r[q].replace(/^language-/,"");if(e[p]){return p}}}function c(q){var p=[];(function(s,t){for(var r=0;r<s.childNodes.length;r++){if(s.childNodes[r].nodeType==3){t+=s.childNodes[r].nodeValue.length}else{if(s.childNodes[r].nodeName=="BR"){t+=1}else{if(s.childNodes[r].nodeType==1){p.push({event:"start",offset:t,node:s.childNodes[r]});t=arguments.callee(s.childNodes[r],t);p.push({event:"stop",offset:t,node:s.childNodes[r]})}}}}return t})(q,0);return p}function k(y,w,x){var q=0;var z="";var s=[];function u(){if(y.length&&w.length){if(y[0].offset!=w[0].offset){return(y[0].offset<w[0].offset)?y:w}else{return w[0].event=="start"?y:w}}else{return y.length?y:w}}function t(D){var A="<"+D.nodeName.toLowerCase();for(var B=0;B<D.attributes.length;B++){var C=D.attributes[B];A+=" "+C.nodeName.toLowerCase();if(C.value!==undefined&&C.value!==false&&C.value!==null){A+='="'+m(C.value)+'"'}}return A+">"}while(y.length||w.length){var v=u().splice(0,1)[0];z+=m(x.substr(q,v.offset-q));q=v.offset;if(v.event=="start"){z+=t(v.node);s.push(v.node)}else{if(v.event=="stop"){var p,r=s.length;do{r--;p=s[r];z+=("</"+p.nodeName.toLowerCase()+">")}while(p!=v.node);s.splice(r,1);while(r<s.length){z+=t(s[r]);r++}}}}return z+m(x.substr(q))}function j(){function q(x,y,v){if(x.compiled){return}var u;var s=[];if(x.k){x.lR=f(y,x.l||hljs.IR,true);for(var w in x.k){if(!x.k.hasOwnProperty(w)){continue}if(x.k[w] instanceof Object){u=x.k[w]}else{u=x.k;w="keyword"}for(var r in u){if(!u.hasOwnProperty(r)){continue}x.k[r]=[w,u[r]];s.push(r)}}}if(!v){if(x.bWK){x.b="\\b("+s.join("|")+")\\s"}x.bR=f(y,x.b?x.b:"\\B|\\b");if(!x.e&&!x.eW){x.e="\\B|\\b"}if(x.e){x.eR=f(y,x.e)}}if(x.i){x.iR=f(y,x.i)}if(x.r===undefined){x.r=1}if(!x.c){x.c=[]}x.compiled=true;for(var t=0;t<x.c.length;t++){if(x.c[t]=="self"){x.c[t]=x}q(x.c[t],y,false)}if(x.starts){q(x.starts,y,false)}}for(var p in e){if(!e.hasOwnProperty(p)){continue}q(e[p].dM,e[p],true)}}function d(B,C){if(!j.called){j();j.called=true}function q(r,M){for(var L=0;L<M.c.length;L++){if((M.c[L].bR.exec(r)||[null])[0]==r){return M.c[L]}}}function v(L,r){if(D[L].e&&D[L].eR.test(r)){return 1}if(D[L].eW){var M=v(L-1,r);return M?M+1:0}return 0}function w(r,L){return L.i&&L.iR.test(r)}function K(N,O){var M=[];for(var L=0;L<N.c.length;L++){M.push(N.c[L].b)}var r=D.length-1;do{if(D[r].e){M.push(D[r].e)}r--}while(D[r+1].eW);if(N.i){M.push(N.i)}return f(O,M.join("|"),true)}function p(M,L){var N=D[D.length-1];if(!N.t){N.t=K(N,E)}N.t.lastIndex=L;var r=N.t.exec(M);return r?[M.substr(L,r.index-L),r[0],false]:[M.substr(L),"",true]}function z(N,r){var L=E.cI?r[0].toLowerCase():r[0];var M=N.k[L];if(M&&M instanceof Array){return M}return false}function F(L,P){L=m(L);if(!P.k){return L}var r="";var O=0;P.lR.lastIndex=0;var M=P.lR.exec(L);while(M){r+=L.substr(O,M.index-O);var N=z(P,M);if(N){x+=N[1];r+='<span class="'+N[0]+'">'+M[0]+"</span>"}else{r+=M[0]}O=P.lR.lastIndex;M=P.lR.exec(L)}return r+L.substr(O,L.length-O)}function J(L,M){if(M.sL&&e[M.sL]){var r=d(M.sL,L);x+=r.keyword_count;return r.value}else{return F(L,M)}}function I(M,r){var L=M.cN?'<span class="'+M.cN+'">':"";if(M.rB){y+=L;M.buffer=""}else{if(M.eB){y+=m(r)+L;M.buffer=""}else{y+=L;M.buffer=r}}D.push(M);A+=M.r}function G(N,M,Q){var R=D[D.length-1];if(Q){y+=J(R.buffer+N,R);return false}var P=q(M,R);if(P){y+=J(R.buffer+N,R);I(P,M);return P.rB}var L=v(D.length-1,M);if(L){var O=R.cN?"</span>":"";if(R.rE){y+=J(R.buffer+N,R)+O}else{if(R.eE){y+=J(R.buffer+N,R)+O+m(M)}else{y+=J(R.buffer+N+M,R)+O}}while(L>1){O=D[D.length-2].cN?"</span>":"";y+=O;L--;D.length--}var r=D[D.length-1];D.length--;D[D.length-1].buffer="";if(r.starts){I(r.starts,"")}return R.rE}if(w(M,R)){throw"Illegal"}}var E=e[B];var D=[E.dM];var A=0;var x=0;var y="";try{var s,u=0;E.dM.buffer="";do{s=p(C,u);var t=G(s[0],s[1],s[2]);u+=s[0].length;if(!t){u+=s[1].length}}while(!s[2]);if(D.length>1){throw"Illegal"}return{r:A,keyword_count:x,value:y}}catch(H){if(H=="Illegal"){return{r:0,keyword_count:0,value:m(C)}}else{throw H}}}function g(t){var p={keyword_count:0,r:0,value:m(t)};var r=p;for(var q in e){if(!e.hasOwnProperty(q)){continue}var s=d(q,t);s.language=q;if(s.keyword_count+s.r>r.keyword_count+r.r){r=s}if(s.keyword_count+s.r>p.keyword_count+p.r){r=p;p=s}}if(r.language){p.second_best=r}return p}function i(r,q,p){if(q){r=r.replace(/^((<[^>]+>|\t)+)/gm,function(t,w,v,u){return w.replace(/\t/g,q)})}if(p){r=r.replace(/\n/g,"<br>")}return r}function n(t,w,r){var x=h(t,r);var v=a(t);var y,s;if(v){y=d(v,x)}else{return}var q=c(t);if(q.length){s=document.createElement("pre");s.innerHTML=y.value;y.value=k(q,c(s),x)}y.value=i(y.value,w,r);var u=t.className;if(!u.match("(\\s|^)(language-)?"+v+"(\\s|$)")){u=u?(u+" "+v):v}if(/MSIE [678]/.test(navigator.userAgent)&&t.tagName=="CODE"&&t.parentNode.tagName=="PRE"){s=t.parentNode;var p=document.createElement("div");p.innerHTML="<pre><code>"+y.value+"</code></pre>";t=p.firstChild.firstChild;p.firstChild.cN=s.cN;s.parentNode.replaceChild(p.firstChild,s)}else{t.innerHTML=y.value}t.className=u;t.result={language:v,kw:y.keyword_count,re:y.r};if(y.second_best){t.second_best={language:y.second_best.language,kw:y.second_best.keyword_count,re:y.second_best.r}}}function o(){if(o.called){return}o.called=true;var r=document.getElementsByTagName("pre");for(var p=0;p<r.length;p++){var q=b(r[p]);if(q){n(q,hljs.tabReplace)}}}function l(){if(window.addEventListener){window.addEventListener("DOMContentLoaded",o,false);window.addEventListener("load",o,false)}else{if(window.attachEvent){window.attachEvent("onload",o)}else{window.onload=o}}}var e={};this.LANGUAGES=e;this.highlight=d;this.highlightAuto=g;this.fixMarkup=i;this.highlightBlock=n;this.initHighlighting=o;this.initHighlightingOnLoad=l;this.IR="[a-zA-Z][a-zA-Z0-9_]*";this.UIR="[a-zA-Z_][a-zA-Z0-9_]*";this.NR="\\b\\d+(\\.\\d+)?";this.CNR="\\b(0[xX][a-fA-F0-9]+|(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)";this.BNR="\\b(0b[01]+)";this.RSR="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|\\.|-|-=|/|/=|:|;|<|<<|<<=|<=|=|==|===|>|>=|>>|>>=|>>>|>>>=|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~";this.ER="(?![\\s\\S])";this.BE={b:"\\\\.",r:0};this.ASM={cN:"string",b:"'",e:"'",i:"\\n",c:[this.BE],r:0};this.QSM={cN:"string",b:'"',e:'"',i:"\\n",c:[this.BE],r:0};this.CLCM={cN:"comment",b:"//",e:"$"};this.CBLCLM={cN:"comment",b:"/\\*",e:"\\*/"};this.HCM={cN:"comment",b:"#",e:"$"};this.NM={cN:"number",b:this.NR,r:0};this.CNM={cN:"number",b:this.CNR,r:0};this.BNM={cN:"number",b:this.BNR,r:0};this.inherit=function(r,s){var p={};for(var q in r){p[q]=r[q]}if(s){for(var q in s){p[q]=s[q]}}return p}}();hljs.LANGUAGES.cpp=function(){var a={keyword:{"false":1,"int":1,"float":1,"while":1,"private":1,"char":1,"catch":1,"export":1,virtual:1,operator:2,sizeof:2,dynamic_cast:2,typedef:2,const_cast:2,"const":1,struct:1,"for":1,static_cast:2,union:1,namespace:1,unsigned:1,"long":1,"throw":1,"volatile":2,"static":1,"protected":1,bool:1,template:1,mutable:1,"if":1,"public":1,friend:2,"do":1,"return":1,"goto":1,auto:1,"void":2,"enum":1,"else":1,"break":1,"new":1,extern:1,using:1,"true":1,"class":1,asm:1,"case":1,typeid:1,"short":1,reinterpret_cast:2,"default":1,"double":1,register:1,explicit:1,signed:1,typename:1,"try":1,"this":1,"switch":1,"continue":1,wchar_t:1,inline:1,"delete":1,alignof:1,char16_t:1,char32_t:1,constexpr:1,decltype:1,noexcept:1,nullptr:1,static_assert:1,thread_local:1,restrict:1,_Bool:1,complex:1},built_in:{std:1,string:1,cin:1,cout:1,cerr:1,clog:1,stringstream:1,istringstream:1,ostringstream:1,auto_ptr:1,deque:1,list:1,queue:1,stack:1,vector:1,map:1,set:1,bitset:1,multiset:1,multimap:1,unordered_set:1,unordered_map:1,unordered_multiset:1,unordered_multimap:1,array:1,shared_ptr:1}};return{dM:{k:a,i:"</",c:[hljs.CLCM,hljs.CBLCLM,hljs.QSM,{cN:"string",b:"'\\\\?.",e:"'",i:"."},{cN:"number",b:"\\b(\\d+(\\.\\d*)?|\\.\\d+)(u|U|l|L|ul|UL|f|F)"},hljs.CNM,{cN:"preprocessor",b:"#",e:"$"},{cN:"stl_container",b:"\\b(deque|list|queue|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array)\\s*<",e:">",k:a,r:10,c:["self"]}]}}}();hljs.LANGUAGES.r={dM:{c:[hljs.HCM,{cN:"number",b:"\\b0[xX][0-9a-fA-F]+[Li]?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+(?:[eE][+\\-]?\\d*)?L\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+\\.(?!\\d)(?:i\\b)?",e:hljs.IMMEDIATE_RE,r:1},{cN:"number",b:"\\b\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\.\\d+(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"keyword",b:"(?:tryCatch|library|setGeneric|setGroupGeneric)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\.",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\d+(?![\\w.])",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\b(?:function)",e:hljs.IMMEDIATE_RE,r:2},{cN:"keyword",b:"(?:if|in|break|next|repeat|else|for|return|switch|while|try|stop|warning|require|attach|detach|source|setMethod|setClass)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"literal",b:"(?:NA|NA_integer_|NA_real_|NA_character_|NA_complex_)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"literal",b:"(?:NULL|TRUE|FALSE|T|F|Inf|NaN)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"identifier",b:"[a-zA-Z.][a-zA-Z0-9._]*\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"<\\-(?!\\s*\\d)",e:hljs.IMMEDIATE_RE,r:2},{cN:"operator",b:"\\->|<\\-",e:hljs.IMMEDIATE_RE,r:1},{cN:"operator",b:"%%|~",e:hljs.IMMEDIATE_RE},{cN:"operator",b:">=|<=|==|!=|\\|\\||&&|=|\\+|\\-|\\*|/|\\^|>|<|!|&|\\||\\$|:",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"%",e:"%",i:"\\n",r:1},{cN:"identifier",b:"`",e:"`",r:0},{cN:"string",b:'"',e:'"',c:[hljs.BE],r:0},{cN:"string",b:"'",e:"'",c:[hljs.BE],r:0},{cN:"paren",b:"[[({\\])}]",e:hljs.IMMEDIATE_RE,r:0}]}};
hljs.initHighlightingOnLoad();
</script>



<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 13px;
}

body {
  max-width: 800px;
  margin: auto;
  padding: 1em;
  line-height: 20px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 {
   font-size:2.2em;
}

h2 {
   font-size:1.8em;
}

h3 {
   font-size:1.4em;
}

h4 {
   font-size:1.0em;
}

h5 {
   font-size:0.9em;
}

h6 {
   font-size:0.8em;
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre, img {
  max-width: 100%;
}
pre {
  overflow-x: auto;
}
pre code {
   display: block; padding: 0.5em;
}

code {
  font-size: 92%;
  border: 1px solid #ccc;
}

code[class] {
  background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * {
      background: transparent !important;
      color: black !important;
      filter:none !important;
      -ms-filter: none !important;
   }

   body {
      font-size:12pt;
      max-width:100%;
   }

   a, a:visited {
      text-decoration: underline;
   }

   hr {
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote {
      padding-right: 1em;
      page-break-inside: avoid;
   }

   tr, img {
      page-break-inside: avoid;
   }

   img {
      max-width: 100% !important;
   }

   @page :left {
      margin: 15mm 20mm 15mm 10mm;
   }

   @page :right {
      margin: 15mm 10mm 15mm 20mm;
   }

   p, h2, h3 {
      orphans: 3; widows: 3;
   }

   h2, h3 {
      page-break-after: avoid;
   }
}
</style>



</head>

<body>
<div id="toc">
<div id="toc_header">Table of Contents</div>
<ul>
<li>
<a href="#toc_0">EWAS in meffil</a>
<ul>
<li>
<a href="#toc_1">Download example data set</a>
</li>
<li>
<a href="#toc_2">Normalize dataset</a>
</li>
<li>
<a href="#toc_3">Test associations with gestational age</a>
</li>
</ul>
</li>
</ul>
</div>


<h1 id="toc_0">EWAS in meffil</h1>

<h2 id="toc_1">Download example data set</h2>

<blockquote>
<p>Sen A, Cingolani P, Senut MC, Land S et al. Lead exposure induces
changes in 5-hydroxymethylcytosine clusters in CpG islands in human
embryonic stem cells and umbilical cord blood. Epigenetics
2015;10(7):607-21. PMID: 26046694</p>
</blockquote>

<p>Retrieve the data from the Gene Expression Omnibus (GEO) website
(<a href="http://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE69633">http://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE69633</a>).</p>

<pre><code class="r">download.450k.lead.dataset &lt;- function() {
    dir.create(path &lt;- &quot;data-450k-lead&quot;)

    if (length(list.files(path, &quot;*.idat$&quot;)) == 0) {
        filename &lt;-  file.path(path, &quot;gse69633.tar&quot;)
        download.file(&quot;http://www.ncbi.nlm.nih.gov/geo/download/?acc=GSE69633&amp;format=file&quot;, filename)
        cat(date(), &quot;Extracting files from GEO archive.\n&quot;)
        system(paste(&quot;cd&quot;, path, &quot;;&quot;, &quot;tar xvf&quot;, basename(filename)))
        unlink(filename)
        cat(date(), &quot;Unzipping IDAT files.\n&quot;)
        system(paste(&quot;cd&quot;, path, &quot;;&quot;, &quot;gunzip *.idat.gz&quot;))

        library(GEOquery)
        geo &lt;- getGEO(&quot;GSE69633&quot;, GSEMatrix=F)
        ## this output from geo is really messed up.
        xx &lt;- lapply(geo@gsms, function(x) x@header)
        characteristics &lt;- t(sapply(xx, function(x) x$characteristics_ch1))
        colnames(characteristics) &lt;- sub(&quot;([^:]+):.*&quot;, &quot;\\1&quot;, characteristics[1,])
        rownames(characteristics) &lt;- names(xx)
        characteristics &lt;- apply(characteristics, 2, function(x) sub(&quot;[^:]+: (.*)&quot;, &quot;\\1&quot;, x))
        characteristics &lt;- as.data.frame(characteristics, stringsAsFactors=F)
        for (name in c(&quot;socioeconomic score&quot;, &quot;gestational age&quot;, &quot;birth weight&quot;, &quot;pbconc (ng/dl)&quot;))
            characteristics[[name]] &lt;- as.numeric(characteristics[[name]])
        write.csv(characteristics, file=file.path(path, &quot;samples.csv&quot;))
    }

    path
}
</code></pre>

<pre><code class="r">path &lt;- download.450k.lead.dataset()
</code></pre>

<h2 id="toc_2">Normalize dataset</h2>

<p>Create samplesheet</p>

<pre><code class="r">library(meffil)
</code></pre>

<pre><code>## Loading required package: illuminaio
</code></pre>

<pre><code>## Loading required package: MASS
</code></pre>

<pre><code>## Loading required package: lmtest
</code></pre>

<pre><code>## Loading required package: zoo
</code></pre>

<pre><code>## 
## Attaching package: &#39;zoo&#39;
</code></pre>

<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     as.Date, as.Date.numeric
</code></pre>

<pre><code>## Loading required package: sandwich
</code></pre>

<pre><code>## Loading required package: limma
</code></pre>

<pre><code>## 
## Attaching package: &#39;limma&#39;
</code></pre>

<pre><code>## The following object is masked from &#39;package:BiocGenerics&#39;:
## 
##     plotMA
</code></pre>

<pre><code>## Loading required package: sva
</code></pre>

<pre><code>## Loading required package: mgcv
</code></pre>

<pre><code>## Loading required package: nlme
</code></pre>

<pre><code>## This is mgcv 1.8-28. For overview type &#39;help(&quot;mgcv-package&quot;)&#39;.
</code></pre>

<pre><code>## Loading required package: genefilter
</code></pre>

<pre><code>## 
## Attaching package: &#39;genefilter&#39;
</code></pre>

<pre><code>## The following object is masked from &#39;package:MASS&#39;:
## 
##     area
</code></pre>

<pre><code>## Loading required package: BiocParallel
</code></pre>

<pre><code>## Loading required package: ggplot2
</code></pre>

<pre><code>## Loading required package: plyr
</code></pre>

<pre><code>## Loading required package: reshape2
</code></pre>

<pre><code>## Loading required package: gridExtra
</code></pre>

<pre><code>## 
## Attaching package: &#39;gridExtra&#39;
</code></pre>

<pre><code>## The following object is masked from &#39;package:Biobase&#39;:
## 
##     combine
</code></pre>

<pre><code>## The following object is masked from &#39;package:BiocGenerics&#39;:
## 
##     combine
</code></pre>

<pre><code>## Loading required package: matrixStats
</code></pre>

<pre><code>## 
## Attaching package: &#39;matrixStats&#39;
</code></pre>

<pre><code>## The following object is masked from &#39;package:plyr&#39;:
## 
##     count
</code></pre>

<pre><code>## The following objects are masked from &#39;package:genefilter&#39;:
## 
##     rowSds, rowVars
</code></pre>

<pre><code>## The following objects are masked from &#39;package:Biobase&#39;:
## 
##     anyMissing, rowMedians
</code></pre>

<pre><code>## Loading required package: multcomp
</code></pre>

<pre><code>## Loading required package: mvtnorm
</code></pre>

<pre><code>## Loading required package: TH.data
</code></pre>

<pre><code>## 
## Attaching package: &#39;TH.data&#39;
</code></pre>

<pre><code>## The following object is masked from &#39;package:MASS&#39;:
## 
##     geyser
</code></pre>

<pre><code>## Loading required package: lme4
</code></pre>

<pre><code>## Loading required package: Matrix
</code></pre>

<pre><code>## 
## Attaching package: &#39;lme4&#39;
</code></pre>

<pre><code>## The following object is masked from &#39;package:nlme&#39;:
## 
##     lmList
</code></pre>

<pre><code>## Loading required package: fastICA
</code></pre>

<pre><code>## Loading required package: DNAcopy
</code></pre>

<pre><code>## Loading required package: quadprog
</code></pre>

<pre><code>## Loading required package: statmod
</code></pre>

<pre><code>## Loading required package: gdsfmt
</code></pre>

<pre><code>## Loading required package: SmartSVA
</code></pre>

<pre><code>## Loading required package: isva
</code></pre>

<pre><code>## Loading required package: qvalue
</code></pre>

<pre><code>## 
## Attaching package: &#39;qvalue&#39;
</code></pre>

<pre><code>## The following object is masked from &#39;package:ggplot2&#39;:
## 
##     qplot
</code></pre>

<pre><code>## Loading required package: JADE
</code></pre>

<pre><code>## Loading required package: RSpectra
</code></pre>

<pre><code>## Loading required package: preprocessCore
</code></pre>

<pre><code class="r">options(mc.cores=10)
samplesheet &lt;- meffil.create.samplesheet(path)

samples &lt;- read.csv(file.path(path, &quot;samples.csv&quot;), check.names=F, row.names=1)
samplesheet &lt;- data.frame(samplesheet,
                          samples[match(samplesheet$Sample_Name, rownames(samples)),],
                          stringsAsFactors=F, check.names=F)

samplesheet &lt;- samplesheet[which(samplesheet[[&quot;sample type&quot;]] == &quot;HM450K&quot;),]
</code></pre>

<p>Parameters.</p>

<pre><code class="r">qc.file &lt;- &quot;ewas/qc-report.html&quot;
author &lt;- &quot;Sen, et al.&quot;
study &lt;- &quot;Cord blood DNA methylation and lead exposure (GSE69633)&quot;
norm.file &lt;- &quot;ewas/normalization-report.html&quot;
cell.type.reference &lt;- &quot;gervin and lyle cord blood&quot;
</code></pre>

<p>Generate QC objects for each sample and QC report.</p>

<pre><code class="r">qc.objects &lt;- meffil.qc(samplesheet, cell.type.reference=cell.type.reference, verbose=T)
</code></pre>

<pre><code>## [read.idat] Thu Jun 24 23:55:03 2021 Reading data-450k-lead/GSM1704996_5815073001_R04C01_Grn.idat 
## [read.idat] Thu Jun 24 23:55:03 2021 Reading data-450k-lead/GSM1704996_5815073001_R04C01_Red.idat 
## [extract.detection.pvalues] Thu Jun 24 23:55:04 2021  
## [extract.beadnum] Thu Jun 24 23:55:08 2021  
## [extract.snp.betas] Thu Jun 24 23:55:11 2021  
## [extract.controls] Thu Jun 24 23:55:11 2021  
## [background.correct] Thu Jun 24 23:55:15 2021 background correction for dye = R 
## [background.correct] Thu Jun 24 23:55:16 2021 background correction for dye = G 
## [dye.bias.correct] Thu Jun 24 23:55:18 2021  
## [FUN] Thu Jun 24 23:55:22 2021 predicting sex
</code></pre>

<pre><code class="r">qc.summary &lt;- meffil.qc.summary(qc.objects, verbose=T)
</code></pre>

<pre><code>## [meffil.qc.summary] Thu Jun 24 23:57:10 2021 Sex summary TRUE 
## [meffil.qc.summary] Thu Jun 24 23:57:10 2021 Meth vs unmeth summary 
## [meffil.qc.summary] Thu Jun 24 23:57:11 2021 Control means summary 
## [meffil.qc.summary] Thu Jun 24 23:57:11 2021 Sample detection summary 
## [meffil.qc.summary] Thu Jun 24 23:57:14 2021 CpG detection summary 
## [meffil.qc.summary] Thu Jun 24 23:57:15 2021 Sample bead numbers summary 
## [meffil.qc.summary] Thu Jun 24 23:57:16 2021 CpG bead numbers summary 
## [meffil.qc.summary] Thu Jun 24 23:57:17 2021 Cell count summary 
## [meffil.qc.summary] Thu Jun 24 23:57:17 2021 Genotype concordance
</code></pre>

<pre><code class="r">meffil.qc.report(qc.summary,
                 output.file=qc.file,
                 author=author,
                 study=study)
</code></pre>

<pre><code>## [meffil.qc.report] Thu Jun 24 23:57:18 2021 Writing report as html file to ewas/qc-report.html
</code></pre>

<pre><code>## `geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;
</code></pre>

<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
</code></pre>

<p>Remove any low quality samples.</p>

<pre><code class="r">if (nrow(qc.summary$bad.samples) &gt; 0)
    qc.objects &lt;- meffil.remove.samples(qc.objects, qc.summary$bad.samples$sample.name)

samplesheet &lt;- samplesheet[match(names(qc.objects), rownames(samplesheet)),]
</code></pre>

<p>Check how many principal components to include.</p>

<pre><code class="r">print(meffil.plot.pc.fit(qc.objects, n.cross=3)$plot)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-6"/></p>

<p>Ten seems about right.</p>

<pre><code class="r">number.pcs &lt;- 10
</code></pre>

<p>Normalize dataset and generate normalization report.</p>

<pre><code class="r">norm.objects &lt;- meffil.normalize.quantiles(qc.objects, number.pcs=number.pcs, verbose=T)
</code></pre>

<pre><code>## [meffil.normalize.quantiles] Thu Jun 24 23:58:10 2021 selecting dye correction reference 
## [meffil.normalize.quantiles] Thu Jun 24 23:58:10 2021 creating control matrix 
## [meffil.normalize.quantiles] Thu Jun 24 23:58:10 2021 normalizing quantiles 
## [FUN] Thu Jun 24 23:58:10 2021 genomic.iG M 
## [FUN] Thu Jun 24 23:58:10 2021 genomic.iG U 
## [FUN] Thu Jun 24 23:58:10 2021 genomic.iR M 
## [FUN] Thu Jun 24 23:58:10 2021 genomic.iR U 
## [FUN] Thu Jun 24 23:58:11 2021 genomic.ii M 
## [FUN] Thu Jun 24 23:58:11 2021 genomic.ii U 
## [FUN] Thu Jun 24 23:58:11 2021 autosomal.iG M 
## [FUN] Thu Jun 24 23:58:11 2021 autosomal.iG U 
## [FUN] Thu Jun 24 23:58:11 2021 autosomal.iR M 
## [FUN] Thu Jun 24 23:58:11 2021 autosomal.iR U 
## [FUN] Thu Jun 24 23:58:11 2021 autosomal.ii M 
## [FUN] Thu Jun 24 23:58:11 2021 autosomal.ii U 
## [FUN] Thu Jun 24 23:58:11 2021 not.y.iG M 
## [FUN] Thu Jun 24 23:58:12 2021 not.y.iG U 
## [FUN] Thu Jun 24 23:58:12 2021 not.y.iR M 
## [FUN] Thu Jun 24 23:58:12 2021 not.y.iR U 
## [FUN] Thu Jun 24 23:58:12 2021 not.y.ii M 
## [FUN] Thu Jun 24 23:58:12 2021 not.y.ii U 
## [FUN] Thu Jun 24 23:58:13 2021 sex M 
## [FUN] Thu Jun 24 23:58:13 2021 sex U 
## [FUN] Thu Jun 24 23:58:13 2021 chrx M 
## [FUN] Thu Jun 24 23:58:13 2021 chrx U 
## [FUN] Thu Jun 24 23:58:13 2021 chry M 
## [FUN] Thu Jun 24 23:58:13 2021 chry U
</code></pre>

<pre><code class="r">norm.dataset &lt;- meffil.normalize.samples(norm.objects,
                                         just.beta=F, 
                                         cpglist.remove=qc.summary$bad.cpgs$name,
                                         verbose=T)
</code></pre>

<pre><code>## [read.idat] Thu Jun 24 23:58:13 2021 Reading data-450k-lead/GSM1704996_5815073001_R04C01_Grn.idat 
## [read.idat] Thu Jun 24 23:58:14 2021 Reading data-450k-lead/GSM1704996_5815073001_R04C01_Red.idat 
## [background.correct] Thu Jun 24 23:58:14 2021 background correction for dye = R 
## [background.correct] Thu Jun 24 23:58:16 2021 background correction for dye = G 
## [dye.bias.correct] Thu Jun 24 23:58:18 2021  
## [meffil.normalize.sample] Thu Jun 24 23:58:20 2021 Normalizing methylated and unmethylated signals.
</code></pre>

<pre><code class="r">beta &lt;- meffil.get.beta(norm.dataset$M, norm.dataset$U)
pcs &lt;- meffil.methylation.pcs(beta, sites=meffil.get.autosomal.sites(&quot;450k&quot;), verbose=T)
</code></pre>

<pre><code>## [meffil.methylation.pcs] Thu Jun 24 23:59:27 2021 Calculating CpG variance 
## [meffil.methylation.pcs] Thu Jun 24 23:59:28 2021 Calculating beta PCs
</code></pre>

<pre><code class="r">parameters &lt;- meffil.normalization.parameters(norm.objects)
norm.summary &lt;- meffil.normalization.summary(norm.objects=norm.objects,
                                             pcs=pcs,
                                             parameters=parameters, verbose=T)
</code></pre>

<pre><code>## [meffil.plot.control.batch] Thu Jun 24 23:59:29 2021 Extracting batch variables 
## [meffil.plot.control.batch] Thu Jun 24 23:59:29 2021 Testing associations 
## [meffil.plot.probe.batch] Thu Jun 24 23:59:44 2021 Extracting batch variables 
## [meffil.plot.probe.batch] Thu Jun 24 23:59:44 2021 Testing associations
</code></pre>

<pre><code class="r">meffil.normalization.report(norm.summary,
                            output.file=norm.file,
                            author=author,
                            study=study)
</code></pre>

<pre><code>## [meffil.normalization.report] Thu Jun 24 23:59:58 2021 Writing report as html file to ewas/normalization-report.html
</code></pre>

<h2 id="toc_3">Test associations with gestational age</h2>

<p>Parameters.</p>

<pre><code class="r">ewas.variable.name &lt;- &quot;gestational age&quot;
ewas.covariate.names &lt;- c(&quot;socioeconomic score&quot;,&quot;gender&quot;,&quot;smoke ever&quot;,&quot;birth weight&quot;)
ewas.output.file &lt;- &quot;ewas/ewas-gestational-age-report.html&quot;
ewas.author &lt;- &quot;Me&quot;
ewas.study &lt;- &quot;Gestational age in cord blood DNA methylation (GEO:GSE69633)&quot;
ewas.cpg.sites &lt;- c(&quot;cg08943494&quot;, &quot;cg11932158&quot;,&quot;cg16725984&quot;, &quot;cg20334115&quot;, &quot;cg18623216&quot;) 
## PMID: 25869828 (top 5)
</code></pre>

<p>Perform EWAS.</p>

<pre><code class="r">variable &lt;- samplesheet[[ewas.variable.name]]
covariates &lt;- data.frame(t(meffil.cell.count.estimates(qc.objects)),
                         samplesheet[,ewas.covariate.names],
                         stringsAsFactors=F)

ewas.ret &lt;- meffil.ewas(beta,
                        variable=variable,
                        covariates=covariates,
                        most.variable=50000,
                        verbose=T)
</code></pre>

<pre><code>## [meffil.ewas] Fri Jun 25 00:02:17 2021 Simplifying any categorical variables. 
## [meffil.ewas] Fri Jun 25 00:02:17 2021 Removing 0 missing case(s). 
## [meffil.ewas] Fri Jun 25 00:02:17 2021 Removing 0 covariates with no variance. 
## [meffil.ewas] Fri Jun 25 00:02:17 2021 Computing surrogate variables ... 
## [add.surrogate.variables] Fri Jun 25 00:02:18 2021 Calculating CpG variance 
## [add.surrogate.variables] Fri Jun 25 00:02:45 2021 smartSVA. 
## 
## [meffil.ewas] Fri Jun 25 00:02:50 2021 Starting EWAS ... 
## [:::] [meffil] [ewas.by.matrix] Fri Jun 25 00:02:51 2021 Handling methylation outliers 
## [FUN] Fri Jun 25 00:03:15 2021 EWAS for covariate set none 
## [:::] [meffil] [ewas.limma] Fri Jun 25 00:03:15 2021 Linear regression with limma::lmFit 
## [:::] [meffil] [ewas.limma] Fri Jun 25 00:03:15 2021 Linear regression with only fixed effects 
## [:::] [meffil] [ewas.limma] Fri Jun 25 00:03:17 2021 Empirical Bayes 
## [FUN] Fri Jun 25 00:03:23 2021 EWAS for covariate set all 
## [:::] [meffil] [ewas.limma] Fri Jun 25 00:03:23 2021 Linear regression with limma::lmFit 
## [:::] [meffil] [ewas.limma] Fri Jun 25 00:03:23 2021 Linear regression with only fixed effects 
## [:::] [meffil] [ewas.limma] Fri Jun 25 00:03:28 2021 Empirical Bayes 
## [FUN] Fri Jun 25 00:03:40 2021 EWAS for covariate set smartsva 
## [:::] [meffil] [ewas.limma] Fri Jun 25 00:03:40 2021 Linear regression with limma::lmFit 
## [:::] [meffil] [ewas.limma] Fri Jun 25 00:03:40 2021 Linear regression with only fixed effects 
## [:::] [meffil] [ewas.limma] Fri Jun 25 00:03:47 2021 Empirical Bayes 
## [meffil.ewas] Fri Jun 25 00:04:15 2021 Finished EWAS.
</code></pre>

<p>Generate EWAS report.</p>

<pre><code class="r">ewas.parameters &lt;- meffil.ewas.parameters(sig.threshold=1e-5,max.plots=10)
ewas.summary &lt;- meffil.ewas.summary(ewas.ret,
                                    beta,
                                    selected.cpg.sites=ewas.cpg.sites,
                                    parameters=ewas.parameters, verbose=T)
</code></pre>

<pre><code>## [meffil.ewas.summary] Fri Jun 25 07:22:21 2021 QQ plots 
## [meffil.ewas.summary] Fri Jun 25 07:22:50 2021 Manhattan plots 
## [meffil.ewas.summary] Fri Jun 25 07:22:55 2021 CpG site plots: 15 
## [FUN] Fri Jun 25 07:22:57 2021 Plotting cg21887373 
## [FUN] Fri Jun 25 07:22:59 2021 Plotting cg09866743 
## [FUN] Fri Jun 25 07:22:59 2021 Plotting cg08594681 
## [FUN] Fri Jun 25 07:22:59 2021 Plotting cg03958883 
## [FUN] Fri Jun 25 07:22:59 2021 Plotting cg00431924 
## [FUN] Fri Jun 25 07:22:59 2021 Plotting cg01824284 
## [FUN] Fri Jun 25 07:22:59 2021 Plotting cg07787614 
## [FUN] Fri Jun 25 07:22:59 2021 Plotting cg12654199 
## [FUN] Fri Jun 25 07:22:59 2021 Plotting cg12036924 
## [FUN] Fri Jun 25 07:22:59 2021 Plotting cg05822633 
## [FUN] Fri Jun 25 07:23:00 2021 Plotting cg08943494 
## [FUN] Fri Jun 25 07:23:00 2021 Plotting cg11932158 
## [FUN] Fri Jun 25 07:23:00 2021 Plotting cg16725984 
## [FUN] Fri Jun 25 07:23:00 2021 Plotting cg20334115 
## [FUN] Fri Jun 25 07:23:00 2021 Plotting cg18623216 
## [meffil.ewas.summary] Fri Jun 25 07:23:00 2021 Sample characteristics 
## [meffil.ewas.sample.characteristics] Fri Jun 25 07:23:00 2021 summarizing variables 
## [summarize.variable] Fri Jun 25 07:23:00 2021 variable of interest 
## [summarize.variable] Fri Jun 25 07:23:00 2021 Bcell 
## [summarize.variable] Fri Jun 25 07:23:00 2021 CD14 
## [summarize.variable] Fri Jun 25 07:23:00 2021 CD4T 
## [summarize.variable] Fri Jun 25 07:23:00 2021 CD8T 
## [summarize.variable] Fri Jun 25 07:23:00 2021 Gran 
## [summarize.variable] Fri Jun 25 07:23:00 2021 NK 
## [summarize.variable] Fri Jun 25 07:23:00 2021 socioeconomic.score 
## [summarize.variable] Fri Jun 25 07:23:00 2021 gender 
## [summarize.variable] Fri Jun 25 07:23:00 2021 smoke.ever 
## [summarize.variable] Fri Jun 25 07:23:00 2021 birth.weight 
## [meffil.ewas.covariate.associations] Fri Jun 25 07:23:00 2021 covariate associations 
## [FUN] Fri Jun 25 07:23:00 2021 Bcell 
## [FUN] Fri Jun 25 07:23:00 2021 CD14 
## [FUN] Fri Jun 25 07:23:00 2021 CD4T 
## [FUN] Fri Jun 25 07:23:00 2021 CD8T 
## [FUN] Fri Jun 25 07:23:00 2021 Gran 
## [FUN] Fri Jun 25 07:23:00 2021 NK 
## [FUN] Fri Jun 25 07:23:00 2021 socioeconomic.score 
## [FUN] Fri Jun 25 07:23:00 2021 gender 
## [FUN] Fri Jun 25 07:23:00 2021 smoke.ever 
## [FUN] Fri Jun 25 07:23:00 2021 birth.weight
</code></pre>

<pre><code class="r">meffil.ewas.report(ewas.summary,
                   output.file=ewas.output.file,
                   author=ewas.author,
                   study=ewas.study)
</code></pre>

<pre><code>## [meffil.ewas.report] Fri Jun 25 07:23:00 2021 Writing report as html file to ewas/ewas-gestational-age-report.html
</code></pre>

<pre><code class="r">idx &lt;- sample(order(ewas.ret$analyses$smartsva$table$p.value)[1:1000],100)
sub.sites &lt;- rownames(beta)[idx]
sub.covariates &lt;- cbind(covariates, with(ewas.ret$analyses$smartsva, design[,grep(&quot;^X[0-9]+$&quot;, colnames(design))]))

ewas.sub.ret &lt;- meffil.ewas(beta,
                            variable=variable,
                            sites=sub.sites,
                            covariates=sub.covariates,
                            sva=F, isva=F, smartsva=F,
                            verbose=T)
</code></pre>

<pre><code>## [meffil.ewas] Fri Jun 25 07:23:56 2021 Simplifying any categorical variables. 
## [meffil.ewas] Fri Jun 25 07:23:56 2021 Removing 0 missing case(s). 
## [meffil.ewas] Fri Jun 25 07:23:56 2021 Removing 0 covariates with no variance. 
## [meffil.ewas] Fri Jun 25 07:23:56 2021 Starting EWAS ... 
## [:::] [meffil] [ewas.by.matrix] Fri Jun 25 07:23:56 2021 Handling methylation outliers 
## [FUN] Fri Jun 25 07:23:56 2021 EWAS for covariate set none 
## [:::] [meffil] [ewas.limma] Fri Jun 25 07:23:56 2021 Linear regression with limma::lmFit 
## [:::] [meffil] [ewas.limma] Fri Jun 25 07:23:56 2021 Linear regression with only fixed effects 
## [:::] [meffil] [ewas.limma] Fri Jun 25 07:23:56 2021 Empirical Bayes 
## [FUN] Fri Jun 25 07:23:56 2021 EWAS for covariate set all 
## [:::] [meffil] [ewas.limma] Fri Jun 25 07:23:56 2021 Linear regression with limma::lmFit 
## [:::] [meffil] [ewas.limma] Fri Jun 25 07:23:56 2021 Linear regression with only fixed effects 
## [:::] [meffil] [ewas.limma] Fri Jun 25 07:23:56 2021 Empirical Bayes 
## [meffil.ewas] Fri Jun 25 07:23:56 2021 Finished EWAS.
</code></pre>

<pre><code class="r">ewas.parameters &lt;- meffil.ewas.parameters(sig.threshold=0.05/length(sub.sites),max.plots=10)
ewas.summary &lt;- meffil.ewas.summary(ewas.sub.ret,
                                    beta,
                                    selected.cpg.sites=sub.sites,
                                    parameters=ewas.parameters, verbose=T)
</code></pre>

<pre><code>## [meffil.ewas.summary] Fri Jun 25 07:23:57 2021 QQ plots 
## [meffil.ewas.summary] Fri Jun 25 07:23:57 2021 Manhattan plots 
## [meffil.ewas.summary] Fri Jun 25 07:23:57 2021 CpG site plots: 100 
## [FUN] Fri Jun 25 07:23:57 2021 Plotting cg02985787 
## [FUN] Fri Jun 25 07:23:57 2021 Plotting cg08899215 
## [FUN] Fri Jun 25 07:23:57 2021 Plotting cg23677272 
## [FUN] Fri Jun 25 07:23:57 2021 Plotting cg05151185 
## [FUN] Fri Jun 25 07:23:57 2021 Plotting cg23981172 
## [FUN] Fri Jun 25 07:23:57 2021 Plotting cg12758090 
## [FUN] Fri Jun 25 07:23:57 2021 Plotting cg23911637 
## [FUN] Fri Jun 25 07:23:57 2021 Plotting cg08891096 
## [FUN] Fri Jun 25 07:23:57 2021 Plotting cg13567725 
## [FUN] Fri Jun 25 07:23:57 2021 Plotting cg01395261 
## [FUN] Fri Jun 25 07:23:57 2021 Plotting cg02938179 
## [FUN] Fri Jun 25 07:23:57 2021 Plotting cg05265849 
## [FUN] Fri Jun 25 07:23:57 2021 Plotting cg05055833 
## [FUN] Fri Jun 25 07:23:57 2021 Plotting cg00090282 
## [FUN] Fri Jun 25 07:23:57 2021 Plotting cg19705386 
## [FUN] Fri Jun 25 07:23:57 2021 Plotting cg08680764 
## [FUN] Fri Jun 25 07:23:57 2021 Plotting cg27035201 
## [FUN] Fri Jun 25 07:23:58 2021 Plotting cg07850246 
## [FUN] Fri Jun 25 07:23:58 2021 Plotting cg13842648 
## [FUN] Fri Jun 25 07:23:58 2021 Plotting cg11022804 
## [FUN] Fri Jun 25 07:23:58 2021 Plotting cg26706003 
## [FUN] Fri Jun 25 07:23:58 2021 Plotting cg06518708 
## [FUN] Fri Jun 25 07:23:58 2021 Plotting cg25809697 
## [FUN] Fri Jun 25 07:23:58 2021 Plotting cg21820652 
## [FUN] Fri Jun 25 07:23:58 2021 Plotting cg09613510 
## [FUN] Fri Jun 25 07:23:58 2021 Plotting cg10245797 
## [FUN] Fri Jun 25 07:23:58 2021 Plotting cg14259326 
## [FUN] Fri Jun 25 07:23:58 2021 Plotting cg04825215 
## [FUN] Fri Jun 25 07:23:58 2021 Plotting cg04636870 
## [FUN] Fri Jun 25 07:23:58 2021 Plotting cg09549015 
## [FUN] Fri Jun 25 07:23:58 2021 Plotting cg20097219 
## [FUN] Fri Jun 25 07:23:58 2021 Plotting cg14732013 
## [FUN] Fri Jun 25 07:23:58 2021 Plotting cg07217710 
## [FUN] Fri Jun 25 07:23:58 2021 Plotting cg07905696 
## [FUN] Fri Jun 25 07:23:58 2021 Plotting cg14726139 
## [FUN] Fri Jun 25 07:23:58 2021 Plotting cg04517263 
## [FUN] Fri Jun 25 07:23:58 2021 Plotting cg23046918 
## [FUN] Fri Jun 25 07:23:58 2021 Plotting cg16206364 
## [FUN] Fri Jun 25 07:23:58 2021 Plotting cg07488417 
## [FUN] Fri Jun 25 07:23:58 2021 Plotting cg21287411 
## [FUN] Fri Jun 25 07:23:59 2021 Plotting cg21776568 
## [FUN] Fri Jun 25 07:23:59 2021 Plotting cg25219643 
## [FUN] Fri Jun 25 07:23:59 2021 Plotting cg14935025 
## [FUN] Fri Jun 25 07:23:59 2021 Plotting cg08553477 
## [FUN] Fri Jun 25 07:23:59 2021 Plotting cg20804613 
## [FUN] Fri Jun 25 07:23:59 2021 Plotting cg21899640 
## [FUN] Fri Jun 25 07:23:59 2021 Plotting cg00473639 
## [FUN] Fri Jun 25 07:23:59 2021 Plotting cg08110455 
## [FUN] Fri Jun 25 07:23:59 2021 Plotting cg19800605 
## [FUN] Fri Jun 25 07:23:59 2021 Plotting cg14429204 
## [FUN] Fri Jun 25 07:23:59 2021 Plotting cg04450052 
## [FUN] Fri Jun 25 07:23:59 2021 Plotting cg07699767 
## [FUN] Fri Jun 25 07:23:59 2021 Plotting cg25788719 
## [FUN] Fri Jun 25 07:23:59 2021 Plotting cg18505871 
## [FUN] Fri Jun 25 07:23:59 2021 Plotting cg02475408 
## [FUN] Fri Jun 25 07:23:59 2021 Plotting cg21137244 
## [FUN] Fri Jun 25 07:23:59 2021 Plotting cg26143452 
## [FUN] Fri Jun 25 07:24:00 2021 Plotting cg23480499 
## [FUN] Fri Jun 25 07:24:00 2021 Plotting cg16847374 
## [FUN] Fri Jun 25 07:24:00 2021 Plotting cg07357346 
## [FUN] Fri Jun 25 07:24:00 2021 Plotting cg19395400 
## [FUN] Fri Jun 25 07:24:00 2021 Plotting cg11052535 
## [FUN] Fri Jun 25 07:24:00 2021 Plotting cg01648376 
## [FUN] Fri Jun 25 07:24:00 2021 Plotting cg08109815 
## [FUN] Fri Jun 25 07:24:00 2021 Plotting cg26617333 
## [FUN] Fri Jun 25 07:24:00 2021 Plotting cg26818390 
## [FUN] Fri Jun 25 07:24:00 2021 Plotting cg03571145 
## [FUN] Fri Jun 25 07:24:00 2021 Plotting cg06578434 
## [FUN] Fri Jun 25 07:24:00 2021 Plotting cg25062951 
## [FUN] Fri Jun 25 07:24:00 2021 Plotting cg26581982 
## [FUN] Fri Jun 25 07:24:00 2021 Plotting cg26195358 
## [FUN] Fri Jun 25 07:24:00 2021 Plotting cg05635169 
## [FUN] Fri Jun 25 07:24:00 2021 Plotting cg20541376 
## [FUN] Fri Jun 25 07:24:00 2021 Plotting cg16797473 
## [FUN] Fri Jun 25 07:24:00 2021 Plotting cg16131578 
## [FUN] Fri Jun 25 07:24:00 2021 Plotting cg06148812 
## [FUN] Fri Jun 25 07:24:00 2021 Plotting cg18079499 
## [FUN] Fri Jun 25 07:24:00 2021 Plotting cg14029254 
## [FUN] Fri Jun 25 07:24:00 2021 Plotting cg25439807 
## [FUN] Fri Jun 25 07:24:01 2021 Plotting cg06778844 
## [FUN] Fri Jun 25 07:24:01 2021 Plotting cg25846022 
## [FUN] Fri Jun 25 07:24:01 2021 Plotting cg22607365 
## [FUN] Fri Jun 25 07:24:01 2021 Plotting cg09089053 
## [FUN] Fri Jun 25 07:24:01 2021 Plotting cg04143909 
## [FUN] Fri Jun 25 07:24:01 2021 Plotting cg10894483 
## [FUN] Fri Jun 25 07:24:01 2021 Plotting cg04046238 
## [FUN] Fri Jun 25 07:24:01 2021 Plotting cg20705390 
## [FUN] Fri Jun 25 07:24:01 2021 Plotting cg17745197 
## [FUN] Fri Jun 25 07:24:01 2021 Plotting cg17213060 
## [FUN] Fri Jun 25 07:24:01 2021 Plotting cg01188574 
## [FUN] Fri Jun 25 07:24:01 2021 Plotting cg07368937 
## [FUN] Fri Jun 25 07:24:01 2021 Plotting cg15649384 
## [FUN] Fri Jun 25 07:24:01 2021 Plotting cg17095929 
## [FUN] Fri Jun 25 07:24:01 2021 Plotting cg07563363 
## [FUN] Fri Jun 25 07:24:01 2021 Plotting cg26277754 
## [FUN] Fri Jun 25 07:24:01 2021 Plotting cg13037201 
## [FUN] Fri Jun 25 07:24:01 2021 Plotting cg03466326 
## [FUN] Fri Jun 25 07:24:01 2021 Plotting cg14303122 
## [FUN] Fri Jun 25 07:24:02 2021 Plotting cg17586154 
## [FUN] Fri Jun 25 07:24:02 2021 Plotting cg26311804 
## [meffil.ewas.summary] Fri Jun 25 07:24:02 2021 Sample characteristics 
## [meffil.ewas.sample.characteristics] Fri Jun 25 07:24:02 2021 summarizing variables 
## [summarize.variable] Fri Jun 25 07:24:02 2021 variable of interest 
## [summarize.variable] Fri Jun 25 07:24:02 2021 Bcell 
## [summarize.variable] Fri Jun 25 07:24:02 2021 CD14 
## [summarize.variable] Fri Jun 25 07:24:02 2021 CD4T 
## [summarize.variable] Fri Jun 25 07:24:02 2021 CD8T 
## [summarize.variable] Fri Jun 25 07:24:02 2021 Gran 
## [summarize.variable] Fri Jun 25 07:24:02 2021 NK 
## [summarize.variable] Fri Jun 25 07:24:02 2021 socioeconomic.score 
## [summarize.variable] Fri Jun 25 07:24:02 2021 gender 
## [summarize.variable] Fri Jun 25 07:24:02 2021 smoke.ever 
## [summarize.variable] Fri Jun 25 07:24:02 2021 birth.weight 
## [summarize.variable] Fri Jun 25 07:24:02 2021 X1 
## [summarize.variable] Fri Jun 25 07:24:02 2021 X2 
## [summarize.variable] Fri Jun 25 07:24:02 2021 X3 
## [summarize.variable] Fri Jun 25 07:24:02 2021 X4 
## [summarize.variable] Fri Jun 25 07:24:02 2021 X5 
## [summarize.variable] Fri Jun 25 07:24:02 2021 X6 
## [summarize.variable] Fri Jun 25 07:24:02 2021 X7 
## [summarize.variable] Fri Jun 25 07:24:02 2021 X8 
## [summarize.variable] Fri Jun 25 07:24:02 2021 X9 
## [summarize.variable] Fri Jun 25 07:24:02 2021 X10 
## [summarize.variable] Fri Jun 25 07:24:02 2021 X11 
## [summarize.variable] Fri Jun 25 07:24:02 2021 X12 
## [summarize.variable] Fri Jun 25 07:24:02 2021 X13 
## [summarize.variable] Fri Jun 25 07:24:02 2021 X14 
## [summarize.variable] Fri Jun 25 07:24:02 2021 X15 
## [summarize.variable] Fri Jun 25 07:24:02 2021 X16 
## [summarize.variable] Fri Jun 25 07:24:02 2021 X17 
## [summarize.variable] Fri Jun 25 07:24:02 2021 X18 
## [summarize.variable] Fri Jun 25 07:24:02 2021 X19 
## [summarize.variable] Fri Jun 25 07:24:02 2021 X20 
## [summarize.variable] Fri Jun 25 07:24:02 2021 X21 
## [summarize.variable] Fri Jun 25 07:24:02 2021 X22 
## [summarize.variable] Fri Jun 25 07:24:02 2021 X23 
## [summarize.variable] Fri Jun 25 07:24:02 2021 X24 
## [summarize.variable] Fri Jun 25 07:24:02 2021 X25 
## [summarize.variable] Fri Jun 25 07:24:02 2021 X26 
## [summarize.variable] Fri Jun 25 07:24:02 2021 X27 
## [meffil.ewas.covariate.associations] Fri Jun 25 07:24:02 2021 covariate associations 
## [FUN] Fri Jun 25 07:24:02 2021 Bcell 
## [FUN] Fri Jun 25 07:24:02 2021 CD14 
## [FUN] Fri Jun 25 07:24:02 2021 CD4T 
## [FUN] Fri Jun 25 07:24:02 2021 CD8T 
## [FUN] Fri Jun 25 07:24:02 2021 Gran 
## [FUN] Fri Jun 25 07:24:02 2021 NK 
## [FUN] Fri Jun 25 07:24:02 2021 socioeconomic.score 
## [FUN] Fri Jun 25 07:24:02 2021 gender 
## [FUN] Fri Jun 25 07:24:02 2021 smoke.ever 
## [FUN] Fri Jun 25 07:24:02 2021 birth.weight 
## [FUN] Fri Jun 25 07:24:02 2021 X1 
## [FUN] Fri Jun 25 07:24:02 2021 X2 
## [FUN] Fri Jun 25 07:24:02 2021 X3 
## [FUN] Fri Jun 25 07:24:02 2021 X4 
## [FUN] Fri Jun 25 07:24:02 2021 X5 
## [FUN] Fri Jun 25 07:24:02 2021 X6 
## [FUN] Fri Jun 25 07:24:02 2021 X7 
## [FUN] Fri Jun 25 07:24:02 2021 X8 
## [FUN] Fri Jun 25 07:24:02 2021 X9 
## [FUN] Fri Jun 25 07:24:02 2021 X10 
## [FUN] Fri Jun 25 07:24:02 2021 X11 
## [FUN] Fri Jun 25 07:24:02 2021 X12 
## [FUN] Fri Jun 25 07:24:02 2021 X13 
## [FUN] Fri Jun 25 07:24:02 2021 X14 
## [FUN] Fri Jun 25 07:24:02 2021 X15 
## [FUN] Fri Jun 25 07:24:02 2021 X16 
## [FUN] Fri Jun 25 07:24:02 2021 X17 
## [FUN] Fri Jun 25 07:24:02 2021 X18 
## [FUN] Fri Jun 25 07:24:02 2021 X19 
## [FUN] Fri Jun 25 07:24:02 2021 X20 
## [FUN] Fri Jun 25 07:24:02 2021 X21 
## [FUN] Fri Jun 25 07:24:02 2021 X22 
## [FUN] Fri Jun 25 07:24:02 2021 X23 
## [FUN] Fri Jun 25 07:24:02 2021 X24 
## [FUN] Fri Jun 25 07:24:02 2021 X25 
## [FUN] Fri Jun 25 07:24:02 2021 X26 
## [FUN] Fri Jun 25 07:24:02 2021 X27
</code></pre>

<pre><code class="r">meffil.ewas.report(ewas.summary,
                   output.file=&quot;ewas/ewas-gestational-age-report-100.html&quot;,
                   author=ewas.author,
                   study=ewas.study)
</code></pre>

<pre><code>## [meffil.ewas.report] Fri Jun 25 07:24:02 2021 Writing report as html file to ewas/ewas-gestational-age-report-100.html
</code></pre>

<p>How well does SVA capture batch effects
that are not explicitly included in the model?</p>

<pre><code class="r">slide &lt;- model.matrix(~ 0 + Slide, samplesheet)
row &lt;- model.matrix(~ 0 + sentrix_row, samplesheet)

sv &lt;- ewas.ret$analyses$smartsva$design
sv &lt;- sv[,grep(&quot;X&quot;, colnames(sv))]

library(penalized)

prediction.accuracy &lt;- function(v, p) {
    fit &lt;- optL1(response=v, penalized=p, fold=10, standardize=T, maxiter=1000, model=&quot;logistic&quot;)
    sum((fit$predictions &gt; 0.5) == (v == 1))/length(v)
}

apply(row, 2, prediction.accuracy, sv)
</code></pre>

<pre><code>## lambda= 4.257571     12345678910cvl= -25.95489 
## lambda= 6.888895     12345678910cvl= -30.66967 
## lambda= 2.631324     12345678910cvl= -21.62959 
## lambda= 1.626248     12345678910cvl= -20.07138 
## lambda= 1.005076     12345678910cvl= -18.43362 
## lambda= 0.6211713    12345678910cvl= -17.61779 
## lambda= 0.383905     12345678910cvl= -17.18751 
## lambda= 0.2372663    12345678910cvl= -17.11563 
## lambda= 0.2394743    12345678910cvl= -17.11179 
## lambda= 0.2947098    12345678910cvl= -17.11477 
## lambda= 0.2605724    12345678910cvl= -17.09026 
## lambda= 0.2662335    12345678910cvl= -17.08902 
## lambda= 0.2670623    12345678910cvl= -17.08894 
## lambda= 0.2691814    12345678910cvl= -17.08885 
## lambda= 0.2692378    12345678910cvl= -17.08885 
## lambda= 0.2819456    12345678910cvl= -17.09836 
## lambda= 0.2755635    12345678910cvl= -17.09186 
## lambda= 0.2723725    12345678910cvl= -17.08907 
## lambda= 0.2707769    12345678910cvl= -17.08889 
## lambda= 0.2699792    12345678910cvl= -17.08886 
## lambda= 0.2695803    12345678910cvl= -17.08885 
## lambda= 0.2693808    12345678910cvl= -17.08885 
## lambda= 0.2692811    12345678910cvl= -17.08885 
## lambda= 0.853562     12345678910cvl= -10.6083 
## lambda= 1.381092     12345678910cvl= -9.536856 
## lambda= 1.707124     12345678910cvl= -9.429087 
## lambda= 1.627066     12345678910cvl= -9.461029 
## lambda= 1.908623     12345678910cvl= -9.427224 
## lambda= 1.811213     12345678910cvl= -9.409251 
## lambda= 1.810357     12345678910cvl= -9.409266 
## lambda= 1.815065     12345678910cvl= -9.409443 
## lambda= 1.811399     12345678910cvl= -9.409248 
## lambda= 1.812799     12345678910cvl= -9.409242 
## lambda= 1.812392     12345678910cvl= -9.409232 
## lambda= 1.812178     12345678910cvl= -9.409235 
## lambda= 3.847889     12345678910cvl= -27.88107 
## lambda= 6.226015     12345678910cvl= -30.71023 
## lambda= 2.378126     12345678910cvl= -25.1397 
## lambda= 1.469763     12345678910cvl= -23.12918 
## lambda= 0.9083633    12345678910cvl= -21.9676 
## lambda= 0.5613994    12345678910cvl= -23.19817 
## lambda= 1.021724     12345678910cvl= -21.96946 
## lambda= 0.9632554    12345678910cvl= -21.93409 
## lambda= 0.9642794    12345678910cvl= -21.93443 
## lambda= 0.9539467    12345678910cvl= -21.93144 
## lambda= 0.9365354    12345678910cvl= -21.93587 
## lambda= 0.9472962    12345678910cvl= -21.93004 
## lambda= 0.9431859    12345678910cvl= -21.9297 
## lambda= 0.9418152    12345678910cvl= -21.93093 
## lambda= 0.9450114    12345678910cvl= -21.92965 
## lambda= 0.9443838    12345678910cvl= -21.92955 
## lambda= 0.944188     12345678910cvl= -21.92952 
## lambda= 0.9438052    12345678910cvl= -21.92946 
## lambda= 0.9435687    12345678910cvl= -21.92943 
## lambda= 0.9434225    12345678910cvl= -21.92949 
## lambda= 0.9436139    12345678910cvl= -21.92944 
## lambda= 1.538301     12345678910cvl= -8.336902 
## lambda= 2.489023     12345678910cvl= -8.961846 
## lambda= 0.9507223    12345678910cvl= -7.572122 
## lambda= 0.5875787    12345678910cvl= -6.980752 
## lambda= 0.3631436    12345678910cvl= -6.719169 
## lambda= 0.2244351    12345678910cvl= -6.650196 
## lambda= 0.1586846    12345678910cvl= -6.543005 
## lambda= 0.09807245   12345678910cvl= -6.480831 
## lambda= 0.02116753   12345678910cvl= -6.632264 
## lambda= 0.1048281    12345678910cvl= -6.484755 
## lambda= 0.06630642   12345678910cvl= -6.481094 
## lambda= 0.08593891   12345678910cvl= -6.476726 
## lambda= 0.08242359   12345678910cvl= -6.476374 
## lambda= 0.0808865    12345678910cvl= -6.476355 
## lambda= 0.08130887   12345678910cvl= -6.476352 
## lambda= 0.08132219   12345678910cvl= -6.476352 
## lambda= 0.08186623   12345678910cvl= -6.476357 
## lambda= 0.08158755   12345678910cvl= -6.476353 
## lambda= 0.08144821   12345678910cvl= -6.476352 
## lambda= 0.08137854   12345678910cvl= -6.476352 
## lambda= 0.0813437    12345678910cvl= -6.476352 
## lambda= 0.08132629   12345678910cvl= -6.476352
</code></pre>

<pre><code>## sentrix_row01 sentrix_row02 sentrix_row04 sentrix_row05 
##     0.7954545     0.9545455     0.7954545     0.9545455
</code></pre>

<pre><code class="r">apply(slide, 2, prediction.accuracy, sv)
</code></pre>

<pre><code>## lambda= 2.164894     12345678910cvl= -12.56481 
## lambda= 3.502872     12345678910cvl= -14.20106 
## lambda= 1.337978     12345678910cvl= -11.05245 
## lambda= 0.826916     12345678910cvl= -10.21312 
## lambda= 0.5110622    12345678910cvl= -9.622109 
## lambda= 0.3158538    12345678910cvl= -8.691505 
## lambda= 0.1952084    12345678910cvl= -8.116996 
## lambda= 0.1206454    12345678910cvl= -7.774021 
## lambda= 0.07456297   12345678910cvl= -7.599894 
## lambda= 0.04608245   12345678910cvl= -7.574176 
## lambda= 0.04861506   12345678910cvl= -7.567134 
## lambda= 0.05714209   12345678910cvl= -7.560187 
## lambda= 0.06379628   12345678910cvl= -7.572326 
## lambda= 0.05522185   12345678910cvl= -7.557584 
## lambda= 0.05411864   12345678910cvl= -7.557026 
## lambda= 0.05377064   12345678910cvl= -7.557405 
## lambda= 0.05444016   12345678910cvl= -7.556695 
## lambda= 0.05473874   12345678910cvl= -7.557001 
## lambda= 0.0544347    12345678910cvl= -7.5567 
## lambda= 0.05451256   12345678910cvl= -7.556739 
## lambda= 0.05446781   12345678910cvl= -7.556688 
## lambda= 0.05445929   12345678910cvl= -7.556678 
## lambda= 0.05445399   12345678910cvl= -7.556681 
## lambda= 1.844311     12345678910cvl= -16.01567 
## lambda= 2.984158     12345678910cvl= -14.34339 
## lambda= 3.688622     12345678910cvl= -14.30763 
## lambda= 3.369437     12345678910cvl= -14.24585 
## lambda= 3.376408     12345678910cvl= -14.24674 
## lambda= 3.222274     12345678910cvl= -14.23005 
## lambda= 3.131322     12345678910cvl= -14.26795 
## lambda= 3.278485     12345678910cvl= -14.23537 
## lambda= 3.187533     12345678910cvl= -14.2332 
## lambda= 3.227153     12345678910cvl= -14.23048 
## lambda= 3.214988     12345678910cvl= -14.22943 
## lambda= 3.204501     12345678910cvl= -14.22856 
## lambda= 3.19802  12345678910cvl= -14.22803 
## lambda= 3.194014     12345678910cvl= -14.22928 
## lambda= 3.200181     12345678910cvl= -14.22821 
## lambda= 3.19649  12345678910cvl= -14.22791 
## lambda= 3.195544     12345678910cvl= -14.22836 
## lambda= 3.197074     12345678910cvl= -14.22796 
## lambda= 3.196129     12345678910cvl= -14.22801 
## lambda= 2.071177     12345678910cvl= -17.84505 
## lambda= 3.351236     12345678910cvl= -16.4617 
## lambda= 4.142355     12345678910cvl= -15.49668 
## lambda= 4.631294     12345678910cvl= -14.87204 
## lambda= 4.933474     12345678910cvl= -14.56606 
## lambda= 5.120232     12345678910cvl= -14.40018 
## lambda= 5.235655     12345678910cvl= -14.30156 
## lambda= 5.30699  12345678910cvl= -14.2509 
## lambda= 5.351078     12345678910cvl= -14.22611 
## lambda= 5.378326     12345678910cvl= -14.2109 
## lambda= 5.395165     12345678910cvl= -14.20153 
## lambda= 5.405573     12345678910cvl= -14.19576 
## lambda= 5.412005     12345678910cvl= -14.1922 
## lambda= 5.415981     12345678910cvl= -14.19 
## lambda= 5.418438     12345678910cvl= -14.18864 
## lambda= 5.419956     12345678910cvl= -14.18781 
## lambda= 5.420895     12345678910cvl= -14.18729 
## lambda= 5.421475     12345678910cvl= -14.18697 
## lambda= 2.551571     12345678910cvl= -14.10562 
## lambda= 4.128529     12345678910cvl= -15.4495 
## lambda= 1.576958     12345678910cvl= -13.14249 
## lambda= 0.9746135    12345678910cvl= -13.80018 
## lambda= 1.689674     12345678910cvl= -13.19736 
## lambda= 1.523065     12345678910cvl= -13.13558 
## lambda= 1.520225     12345678910cvl= -13.13537 
## lambda= 1.31182  12345678910cvl= -13.17379 
## lambda= 1.483266     12345678910cvl= -13.13421 
## lambda= 1.486989     12345678910cvl= -13.1342 
## lambda= 1.485553     12345678910cvl= -13.1342 
## lambda= 1.485584     12345678910cvl= -13.1342 
## lambda= 1.486255     12345678910cvl= -13.1342 
## lambda= 1.48584  12345678910cvl= -13.1342 
## lambda= 1.87052  12345678910cvl= -14.08449 
## lambda= 3.026565     12345678910cvl= -15.25966 
## lambda= 1.156045     12345678910cvl= -13.78942 
## lambda= 0.8733142    12345678910cvl= -14.48185 
## lambda= 1.441335     12345678910cvl= -13.62236 
## lambda= 1.42453  12345678910cvl= -13.62146 
## lambda= 1.42169  12345678910cvl= -13.62141 
## lambda= 1.418178     12345678910cvl= -13.62139 
## lambda= 1.418195     12345678910cvl= -13.6214 
## lambda= 1.318052     12345678910cvl= -13.64603 
## lambda= 1.379933     12345678910cvl= -13.62411 
## lambda= 1.40357  12345678910cvl= -13.62178 
## lambda= 1.412598     12345678910cvl= -13.62145 
## lambda= 1.416047     12345678910cvl= -13.6214 
## lambda= 1.417123     12345678910cvl= -13.62139 
## lambda= 1.417653     12345678910cvl= -13.62139 
## lambda= 1.417977     12345678910cvl= -13.62139 
## lambda= 1.578228     12345678910cvl= -15.12403 
## lambda= 2.553627     12345678910cvl= -14.70242 
## lambda= 3.156456     12345678910cvl= -14.50771 
## lambda= 3.529026     12345678910cvl= -14.39565 
## lambda= 3.759286     12345678910cvl= -14.31964 
## lambda= 3.901595     12345678910cvl= -14.26136 
## lambda= 3.989546     12345678910cvl= -14.22892 
## lambda= 4.043904     12345678910cvl= -14.20934 
## lambda= 4.077498     12345678910cvl= -14.19961 
## lambda= 4.098261     12345678910cvl= -14.19364 
## lambda= 4.111093     12345678910cvl= -14.18996 
## lambda= 4.119023     12345678910cvl= -14.18769 
## lambda= 4.123925     12345678910cvl= -14.1872 
## lambda= 4.124869     12345678910cvl= -14.18711 
## lambda= 4.127537     12345678910cvl= -14.18686 
## lambda= 4.129187     12345678910cvl= -14.1867 
## lambda= 4.130206     12345678910cvl= -14.1866 
## lambda= 4.130836     12345678910cvl= -14.18655 
## lambda= 4.131225     12345678910cvl= -14.18651 
## lambda= 1.339918     12345678910cvl= -16.68664 
## lambda= 2.168033     12345678910cvl= -14.24478 
## lambda= 2.679836     12345678910cvl= -13.13679 
## lambda= 2.996148     12345678910cvl= -12.46982 
## lambda= 3.191639     12345678910cvl= -12.15531 
## lambda= 3.31246  12345678910cvl= -12.0404 
## lambda= 3.387131     12345678910cvl= -11.98753 
## lambda= 3.43328  12345678910cvl= -11.96353 
## lambda= 3.461802     12345678910cvl= -11.94987 
## lambda= 3.479429     12345678910cvl= -11.94154 
## lambda= 3.490324     12345678910cvl= -11.93644 
## lambda= 3.497057     12345678910cvl= -11.9333 
## lambda= 3.501218     12345678910cvl= -11.93136 
## lambda= 3.50379  12345678910cvl= -11.93017 
## lambda= 3.505379     12345678910cvl= -11.92943 
## lambda= 3.506362     12345678910cvl= -11.92897 
## lambda= 3.506969     12345678910cvl= -11.92869 
## lambda= 3.507344     12345678910cvl= -11.92852 
## lambda= 2.09129  12345678910cvl= -13.12899 
## lambda= 3.383778     12345678910cvl= -13.63914 
## lambda= 1.292488     12345678910cvl= -13.47042 
## lambda= 2.23552  12345678910cvl= -13.10516 
## lambda= 2.460498     12345678910cvl= -13.06702 
## lambda= 2.81316  12345678910cvl= -13.31186 
## lambda= 2.595203     12345678910cvl= -13.10497 
## lambda= 2.41557  12345678910cvl= -13.06633 
## lambda= 2.432818     12345678910cvl= -13.06509 
## lambda= 2.43558  12345678910cvl= -13.06494 
## lambda= 2.445098     12345678910cvl= -13.06458 
## lambda= 2.45445  12345678910cvl= -13.06603 
## lambda= 2.441462     12345678910cvl= -13.06466 
## lambda= 2.447904     12345678910cvl= -13.065 
## lambda= 2.443709     12345678910cvl= -13.06457 
## lambda= 2.444233     12345678910cvl= -13.06455 
## lambda= 2.444361     12345678910cvl= -13.06454 
## lambda= 2.444642     12345678910cvl= -13.06453 
## lambda= 0.7971992    12345678910cvl= -32.32838 
## lambda= 1.289895     12345678910cvl= -33.25135 
## lambda= 0.4926962    12345678910cvl= -34.35771 
## lambda= 0.9560885    12345678910cvl= -35.29847 
## lambda= 0.6808894    12345678910cvl= -36.3307 
## lambda= 0.8578895    12345678910cvl= -37.32255 
## lambda= 0.7527728    12345678910cvl= -38.32891 
## lambda= 0.8203808    12345678910cvl= -39.32827 
## lambda= 0.7802298    12345678910cvl= -40.32853 
## lambda= 0.8060538    12345678910cvl= -41.32832 
## lambda= 0.7907175    12345678910cvl= -42.32843 
## lambda= 0.8005813    12345678910cvl= -43.32836 
## lambda= 0.7947234    12345678910cvl= -44.3284 
## lambda= 0.7984911    12345678910cvl= -45.32837 
## lambda= 0.7962535    12345678910cvl= -46.32839 
## lambda= 0.7976926    12345678910cvl= -47.32838 
## lambda= 0.796838     12345678910cvl= -48.32838 
## lambda= 0.7973877    12345678910cvl= -49.32838 
## lambda= 0.7970612    12345678910cvl= -50.32838 
## lambda= 1.008088     12345678910cvl= -9.854413 
## lambda= 1.631121     12345678910cvl= -9.51857 
## lambda= 2.016177     12345678910cvl= -9.342968 
## lambda= 2.254154     12345678910cvl= -9.328613 
## lambda= 2.182653     12345678910cvl= -9.332353 
## lambda= 2.401232     12345678910cvl= -9.320861 
## lambda= 2.492131     12345678910cvl= -9.308395 
## lambda= 2.54831  12345678910cvl= -9.301354 
## lambda= 2.583031     12345678910cvl= -9.297845 
## lambda= 2.604489     12345678910cvl= -9.295733 
## lambda= 2.617751     12345678910cvl= -9.294448 
## lambda= 2.625947     12345678910cvl= -9.293662 
## lambda= 2.631013     12345678910cvl= -9.29318 
## lambda= 2.634144     12345678910cvl= -9.292883 
## lambda= 2.636079     12345678910cvl= -9.292699 
## lambda= 2.637274     12345678910cvl= -9.292586 
## lambda= 2.638014     12345678910cvl= -9.292516 
## lambda= 2.63847  12345678910cvl= -9.292473 
## lambda= 2.638753     12345678910cvl= -9.292447 
## lambda= 1.170796     12345678910cvl= -9.598938 
## lambda= 1.894388     12345678910cvl= -9.288146 
## lambda= 2.341592     12345678910cvl= -9.384041 
## lambda= 1.923054     12345678910cvl= -9.287913 
## lambda= 1.916355     12345678910cvl= -9.287862 
## lambda= 1.914411     12345678910cvl= -9.28786 
## lambda= 1.914471     12345678910cvl= -9.28786 
## lambda= 1.915383     12345678910cvl= -9.28786 
## lambda= 1.914819     12345678910cvl= -9.28786 
## lambda= 2.867136     12345678910cvl= -10.25277 
## lambda= 4.639124     12345678910cvl= -13.68884 
## lambda= 1.771988     12345678910cvl= -9.262945 
## lambda= 1.068023     12345678910cvl= -8.48777 
## lambda= 0.6600748    12345678910cvl= -8.072805 
## lambda= 0.4079487    12345678910cvl= -8.14407 
## lambda= 0.6057789    12345678910cvl= -8.067019 
## lambda= 0.6058427    12345678910cvl= -8.06702 
## lambda= 0.5988237    12345678910cvl= -8.066948 
## lambda= 0.5259159    12345678910cvl= -8.076704 
## lambda= 0.5992216    12345678910cvl= -8.066947 
## lambda= 0.5992419    12345678910cvl= -8.066947 
## lambda= 0.6025003    12345678910cvl= -8.066965 
## lambda= 0.6004865    12345678910cvl= -8.06695 
## lambda= 0.5998541    12345678910cvl= -8.066948 
## lambda= 0.5995378    12345678910cvl= -8.066947 
## lambda= 0.5993797    12345678910cvl= -8.066947 
## lambda= 2.081995     12345678910cvl= -11.27749 
## lambda= 3.368738     12345678910cvl= -13.86971 
## lambda= 1.286744     12345678910cvl= -9.322738 
## lambda= 0.7952513    12345678910cvl= -8.139752 
## lambda= 0.4914923    12345678910cvl= -7.571198 
## lambda= 0.303759     12345678910cvl= -7.376916 
## lambda= 0.09372582   12345678910cvl= -7.335909 
## lambda= 0.1524958    12345678910cvl= -7.265589 
## lambda= 0.1881325    12345678910cvl= -7.274134 
## lambda= 0.1624338    12345678910cvl= -7.265657 
## lambda= 0.1570847    12345678910cvl= -7.265366 
## lambda= 0.1571327    12345678910cvl= -7.265366 
## lambda= 0.1570757    12345678910cvl= -7.265366 
## lambda= 0.1547902    12345678910cvl= -7.265421 
## lambda= 0.1562027    12345678910cvl= -7.265374 
## lambda= 0.1566437    12345678910cvl= -7.265368 
## lambda= 0.1568642    12345678910cvl= -7.265366 
## lambda= 0.1569745    12345678910cvl= -7.265366 
## lambda= 0.1570296    12345678910cvl= -7.265366 
## lambda= 0.1570571    12345678910cvl= -7.265366
</code></pre>

<pre><code>## Slide5815073001 Slide5815073007 Slide5815073008 Slide5815073009 Slide5815073011 
##       0.9318182       0.9090909       0.9090909       0.9090909       0.9090909 
## Slide5815073012 Slide5815073020 Slide5815073029 Slide5815129020 Slide5815129025 
##       0.9090909       0.9318182       0.9090909       0.9772727       0.9545455 
## Slide5815129026 Slide5815233016 Slide5815233019 
##       0.9545455       0.9318182       0.9318182
</code></pre>

<p>How much do the different EWAS models agree?</p>

<pre><code class="r">sapply(ewas.ret$analyses, function(a) 
       sapply(ewas.ret$analyses, function(b) 
              length(intersect(rownames(a$table)[which(a$table$p.value &lt; 0.0001)],
                               rownames(b$table)[which(b$table$p.value &lt; 0.0001)]))))
</code></pre>

<pre><code>##          none all smartsva
## none       87   7        0
## all         7  41        0
## smartsva    0   0       48
</code></pre>

<pre><code class="r">sapply(ewas.ret$analyses, function(a) 
       sapply(ewas.ret$analyses, function(b) {
           a &lt;- rownames(a$table)[which(a$table$p.value &lt; 0.0001)]
           b &lt;- rownames(b$table)[which(b$table$p.value &lt; 0.0001)]
           length(intersect(a,b))/length(union(a,b))
       }))
</code></pre>

<pre><code>##                none        all smartsva
## none     1.00000000 0.05785124        0
## all      0.05785124 1.00000000        0
## smartsva 0.00000000 0.00000000        1
</code></pre>

<pre><code class="r">sapply(ewas.ret$analyses, function(a) 
       sapply(ewas.ret$analyses, function(b) {
           idx &lt;- which(a$table$p.value &lt; 0.01)
           cor(a$table$coefficient[idx], b$table$coefficient[idx])
       }))
</code></pre>

<pre><code>##               none       all  smartsva
## none     1.0000000 0.9219939 0.4954068
## all      0.9195526 1.0000000 0.6638270
## smartsva 0.5385354 0.7391721 1.0000000
</code></pre>

<p>Compare meffil EWAS to EWAS &#39;done by hand&#39;.</p>

<pre><code class="r">## EWAS by meffil
test.ret &lt;- meffil.ewas(beta,
                        variable=variable,
                        covariates=covariates,
                        isva=F,sva=T,smartsva=F,
                        most.variable=50000,
                        random.seed=20161123,
                        verbose=T)
</code></pre>

<pre><code>## [meffil.ewas] Fri Jun 25 07:26:58 2021 Simplifying any categorical variables. 
## [meffil.ewas] Fri Jun 25 07:26:58 2021 Removing 0 missing case(s). 
## [meffil.ewas] Fri Jun 25 07:26:58 2021 Removing 0 covariates with no variance. 
## [meffil.ewas] Fri Jun 25 07:26:58 2021 Computing surrogate variables ... 
## [add.surrogate.variables] Fri Jun 25 07:26:58 2021 Calculating CpG variance 
## [add.surrogate.variables] Fri Jun 25 07:27:22 2021 SVA. 
## Number of significant surrogate variables is:  7 
## Iteration (out of 5 ):1  2  3  4  5  
## [meffil.ewas] Fri Jun 25 07:27:57 2021 Starting EWAS ... 
## [:::] [meffil] [ewas.by.matrix] Fri Jun 25 07:27:57 2021 Handling methylation outliers 
## [FUN] Fri Jun 25 07:28:21 2021 EWAS for covariate set none 
## [:::] [meffil] [ewas.limma] Fri Jun 25 07:28:21 2021 Linear regression with limma::lmFit 
## [:::] [meffil] [ewas.limma] Fri Jun 25 07:28:21 2021 Linear regression with only fixed effects 
## [:::] [meffil] [ewas.limma] Fri Jun 25 07:28:24 2021 Empirical Bayes 
## [FUN] Fri Jun 25 07:28:30 2021 EWAS for covariate set all 
## [:::] [meffil] [ewas.limma] Fri Jun 25 07:28:30 2021 Linear regression with limma::lmFit 
## [:::] [meffil] [ewas.limma] Fri Jun 25 07:28:30 2021 Linear regression with only fixed effects 
## [:::] [meffil] [ewas.limma] Fri Jun 25 07:28:35 2021 Empirical Bayes 
## [FUN] Fri Jun 25 07:28:46 2021 EWAS for covariate set sva 
## [:::] [meffil] [ewas.limma] Fri Jun 25 07:28:46 2021 Linear regression with limma::lmFit 
## [:::] [meffil] [ewas.limma] Fri Jun 25 07:28:46 2021 Linear regression with only fixed effects 
## [:::] [meffil] [ewas.limma] Fri Jun 25 07:28:51 2021 Empirical Bayes 
## [meffil.ewas] Fri Jun 25 07:29:06 2021 Finished EWAS.
</code></pre>

<pre><code class="r">test.ret$sv &lt;- test.ret$analyses$sva$design
test.ret$sv &lt;- test.ret$sv[,grep(&quot;X&quot;, colnames(test.ret$sv))]

## EWAS by hand
beta.win &lt;- meffil:::winsorize(beta)
beta.sva &lt;- beta.win
beta.sva &lt;- beta.sva[which(rownames(beta.sva) %in% meffil.get.autosomal.sites()),]
beta.sva &lt;- beta.sva[order(rowVars(beta.sva), decreasing=T)[1:50000],]
mod0 &lt;- model.matrix(~ ., covariates)
mod &lt;- cbind(mod0, variable)
set.seed(20161123)
sva.ret &lt;- sva(dat=beta.sva, mod=mod, mod0=mod0)
</code></pre>

<pre><code>## Number of significant surrogate variables is:  7 
## Iteration (out of 5 ):1  2  3  4  5
</code></pre>

<pre><code class="r">apply(abs(cor(test.ret$sv, sva.ret$sv)), 2, max)
</code></pre>

<pre><code>## [1] 1 1 1 1 1 1 1
</code></pre>

<pre><code class="r">mod &lt;- cbind(mod, sva.ret$sv)
fit &lt;- lm.fit(mod, t(beta.win))

cor(fit$coefficients[&quot;variable&quot;,], test.ret$analyses$sva$table$coefficient)
</code></pre>

<pre><code>## [1] 1
</code></pre>

<p>View EWAS effect estimates next to genes and other genomic landmarks
by generating genome browser tracks and uploading them
to <a href="https://genome.ucsc.edu/cgi-bin/hgCustom">https://genome.ucsc.edu/cgi-bin/hgCustom</a>.</p>

<pre><code class="r">meffil.ewas.bedgraph(ewas.ret, &quot;ewas/sva.bed&quot;, &quot;smartsva&quot;, name=&quot;ga&quot;, description=ewas.study)
header &lt;- paste0(&quot;track type=bedGraph name=&#39;ga-custom&#39; description=&#39;&quot;,
                 ewas.study,
                 &quot;&#39; visibility=full color=200,100,0 altColor=0,100,200 priority=20&quot;)
meffil.ewas.bedgraph(ewas.ret, &quot;ewas/sva-custom.bed&quot;, &quot;smartsva&quot;, header=header)
meffil.ewas.bedgraph(ewas.ret, &quot;ewas/sva-minimal.bed&quot;, &quot;smartsva&quot;)                    
</code></pre>

</body>

</html>
